(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[103],{56:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SaxesParser=e.EVENTS=void 0;let s=i(345),n=i(422),r=i(9628);var a=s.isS,o=s.isChar,l=s.isNameStartChar,h=s.isNameChar,u=s.S_LIST,c=s.NAME_RE,d=n.isChar,_=r.isNCNameStartChar,m=r.isNCNameChar,g=r.NC_NAME_RE;let p="http://www.w3.org/XML/1998/namespace",f="http://www.w3.org/2000/xmlns/",b={__proto__:null,xml:p,xmlns:f},v={__proto__:null,amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},C=t=>34===t||39===t,y=[34,39],x=[...y,91,62],E=[...y,60,93],M=[61,63,...u],S=[...u,62,38,60];function w(t,e,i){switch(e){case"xml":i!==p&&t.fail(`xml prefix must be bound to ${p}.`);break;case"xmlns":i!==f&&t.fail(`xmlns prefix must be bound to ${f}.`)}switch(i){case f:t.fail(""===e?`the default namespace may not be set to ${i}.`:`may not assign a prefix (even "xmlns") to the URI \
${f}.`);break;case p:switch(e){case"xml":break;case"":t.fail(`the default namespace may not be set to ${i}.`);break;default:t.fail("may not assign the xml namespace to another prefix.")}}}let A=t=>g.test(t),T=t=>c.test(t);e.EVENTS=["xmldecl","text","processinginstruction","doctype","comment","opentagstart","attribute","opentag","closetag","cdata","error","end","ready"];let N={xmldecl:"xmldeclHandler",text:"textHandler",processinginstruction:"piHandler",doctype:"doctypeHandler",comment:"commentHandler",opentagstart:"openTagStartHandler",attribute:"attributeHandler",opentag:"openTagHandler",closetag:"closeTagHandler",cdata:"cdataHandler",error:"errorHandler",end:"endHandler",ready:"readyHandler"};class U{constructor(t){this.opt=null!=t?t:{},this.fragmentOpt=!!this.opt.fragment;let e=this.xmlnsOpt=!!this.opt.xmlns;if(this.trackPosition=!1!==this.opt.position,this.fileName=this.opt.fileName,e){this.nameStartCheck=_,this.nameCheck=m,this.isName=A,this.processAttribs=this.processAttribsNS,this.pushAttrib=this.pushAttribNS,this.ns=Object.assign({__proto__:null},b);let t=this.opt.additionalNamespaces;null!=t&&(!function(t,e){for(let i of Object.keys(e))w(t,i,e[i])}(this,t),Object.assign(this.ns,t))}else this.nameStartCheck=l,this.nameCheck=h,this.isName=T,this.processAttribs=this.processAttribsPlain,this.pushAttrib=this.pushAttribPlain;this.stateTable=[this.sBegin,this.sBeginWhitespace,this.sDoctype,this.sDoctypeQuote,this.sDTD,this.sDTDQuoted,this.sDTDOpenWaka,this.sDTDOpenWakaBang,this.sDTDComment,this.sDTDCommentEnding,this.sDTDCommentEnded,this.sDTDPI,this.sDTDPIEnding,this.sText,this.sEntity,this.sOpenWaka,this.sOpenWakaBang,this.sComment,this.sCommentEnding,this.sCommentEnded,this.sCData,this.sCDataEnding,this.sCDataEnding2,this.sPIFirstChar,this.sPIRest,this.sPIBody,this.sPIEnding,this.sXMLDeclNameStart,this.sXMLDeclName,this.sXMLDeclEq,this.sXMLDeclValueStart,this.sXMLDeclValue,this.sXMLDeclSeparator,this.sXMLDeclEnding,this.sOpenTag,this.sOpenTagSlash,this.sAttrib,this.sAttribName,this.sAttribNameSawWhite,this.sAttribValue,this.sAttribValueQuoted,this.sAttribValueClosed,this.sAttribValueUnquoted,this.sCloseTag,this.sCloseTagSawWhite],this._init()}get closed(){return this._closed}_init(){var t;this.openWakaBang="",this.text="",this.name="",this.piTarget="",this.entity="",this.q=null,this.tags=[],this.tag=null,this.topNS=null,this.chunk="",this.chunkPosition=0,this.i=0,this.prevI=0,this.carriedFromPrevious=void 0,this.forbiddenState=0,this.attribList=[];let{fragmentOpt:e}=this;this.state=e?13:0,this.reportedTextBeforeRoot=this.reportedTextAfterRoot=this.closedRoot=this.sawRoot=e,this.xmlDeclPossible=!e,this.xmlDeclExpects=["version"],this.entityReturnState=void 0;let{defaultXMLVersion:i}=this.opt;if(void 0===i){if(!0===this.opt.forceXMLVersion)throw Error("forceXMLVersion set but defaultXMLVersion is not set");i="1.0"}this.setXMLVersion(i),this.positionAtNewLine=0,this.doctype=!1,this._closed=!1,this.xmlDecl={version:void 0,encoding:void 0,standalone:void 0},this.line=1,this.column=0,this.ENTITIES=Object.create(v),null===(t=this.readyHandler)||void 0===t||t.call(this)}get position(){return this.chunkPosition+this.i}get columnIndex(){return this.position-this.positionAtNewLine}on(t,e){this[N[t]]=e}off(t){this[N[t]]=void 0}makeError(t){var e;let i=null!==(e=this.fileName)&&void 0!==e?e:"";return this.trackPosition&&(i.length>0&&(i+=":"),i+=`${this.line}:${this.column}`),i.length>0&&(i+=": "),Error(i+t)}fail(t){let e=this.makeError(t),i=this.errorHandler;if(void 0===i)throw e;return i(e),this}write(t){if(this.closed)return this.fail("cannot write after close; assign an onready handler.");let e=!1;null===t?(e=!0,t=""):"object"==typeof t&&(t=t.toString()),void 0!==this.carriedFromPrevious&&(t=`${this.carriedFromPrevious}${t}`,this.carriedFromPrevious=void 0);let i=t.length,s=t.charCodeAt(i-1);!e&&(13===s||s>=55296&&s<=56319)&&(this.carriedFromPrevious=t[i-1],i--,t=t.slice(0,i));let{stateTable:n}=this;for(this.chunk=t,this.i=0;this.i<i;)n[this.state].call(this);return this.chunkPosition+=i,e?this.end():this}close(){return this.write(null)}getCode10(){let{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return -1;let i=t.charCodeAt(e);if(this.column++,i<55296){if(i>=32||9===i)return i;switch(i){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:return 10===t.charCodeAt(e+1)&&(this.i=e+2),this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;let s=65536+(i-55296)*1024+(t.charCodeAt(e+1)-56320);return this.i=e+2,s>1114111&&this.fail("disallowed character."),s}getCode11(){let{chunk:t,i:e}=this;if(this.prevI=e,this.i=e+1,e>=t.length)return -1;let i=t.charCodeAt(e);if(this.column++,i<55296){if(i>31&&i<127||i>159&&8232!==i||9===i)return i;switch(i){case 10:return this.line++,this.column=0,this.positionAtNewLine=this.position,10;case 13:{let i=t.charCodeAt(e+1);(10===i||133===i)&&(this.i=e+2)}case 133:case 8232:return this.line++,this.column=0,this.positionAtNewLine=this.position,-2;default:return this.fail("disallowed character."),i}}if(i>56319)return i>=57344&&i<=65533||this.fail("disallowed character."),i;let s=65536+(i-55296)*1024+(t.charCodeAt(e+1)-56320);return this.i=e+2,s>1114111&&this.fail("disallowed character."),s}getCodeNorm(){let t=this.getCode();return -2===t?10:t}unget(){this.i=this.prevI,this.column--}captureTo(t){let{i:e}=this,{chunk:i}=this;for(;;){let s=this.getCode(),n=-2===s,r=n?10:s;if(-1===r||t.includes(r))return this.text+=i.slice(e,this.prevI),r;n&&(this.text+=`${i.slice(e,this.prevI)}
`,e=this.i)}}captureToChar(t){let{i:e}=this,{chunk:i}=this;for(;;){let s=this.getCode();switch(s){case -2:this.text+=`${i.slice(e,this.prevI)}
`,e=this.i,s=10;break;case -1:return this.text+=i.slice(e),!1}if(s===t)return this.text+=i.slice(e,this.prevI),!0}}captureNameChars(){let{chunk:t,i:e}=this;for(;;){let i=this.getCode();if(-1===i)return this.name+=t.slice(e),-1;if(!h(i))return this.name+=t.slice(e,this.prevI),-2===i?10:i}}skipSpaces(){for(;;){let t=this.getCodeNorm();if(-1===t||!a(t))return t}}setXMLVersion(t){this.currentXMLVersion=t,"1.0"===t?(this.isChar=o,this.getCode=this.getCode10):(this.isChar=d,this.getCode=this.getCode11)}sBegin(){65279===this.chunk.charCodeAt(0)&&(this.i++,this.column++),this.state=1}sBeginWhitespace(){let t=this.i,e=this.skipSpaces();switch(this.prevI!==t&&(this.xmlDeclPossible=!1),e){case 60:if(this.state=15,0!==this.text.length)throw Error("no-empty text at start");break;case -1:break;default:this.unget(),this.state=13,this.xmlDeclPossible=!1}}sDoctype(){var t;let e=this.captureTo(x);switch(e){case 62:null===(t=this.doctypeHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=13,this.doctype=!0;break;case -1:break;default:this.text+=String.fromCodePoint(e),91===e?this.state=4:C(e)&&(this.state=3,this.q=e)}}sDoctypeQuote(){let t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.q=null,this.state=2)}sDTD(){let t=this.captureTo(E);-1!==t&&(this.text+=String.fromCodePoint(t),93===t?this.state=2:60===t?this.state=6:C(t)&&(this.state=5,this.q=t))}sDTDQuoted(){let t=this.q;this.captureToChar(t)&&(this.text+=String.fromCodePoint(t),this.state=4,this.q=null)}sDTDOpenWaka(){let t=this.getCodeNorm();switch(this.text+=String.fromCodePoint(t),t){case 33:this.state=7,this.openWakaBang="";break;case 63:this.state=11;break;default:this.state=4}}sDTDOpenWakaBang(){let t=String.fromCodePoint(this.getCodeNorm()),e=this.openWakaBang+=t;this.text+=t,"-"!==e&&(this.state="--"===e?8:4,this.openWakaBang="")}sDTDComment(){this.captureToChar(45)&&(this.text+="-",this.state=9)}sDTDCommentEnding(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),this.state=45===t?10:8}sDTDCommentEnded(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),62===t?this.state=4:(this.fail("malformed comment."),this.state=8)}sDTDPI(){this.captureToChar(63)&&(this.text+="?",this.state=12)}sDTDPIEnding(){let t=this.getCodeNorm();this.text+=String.fromCodePoint(t),62===t&&(this.state=4)}sText(){0!==this.tags.length?this.handleTextInRoot():this.handleTextOutsideRoot()}sEntity(){let{i:t}=this,{chunk:e}=this;t:for(;;)switch(this.getCode()){case -2:this.entity+=`${e.slice(t,this.prevI)}
`,t=this.i;break;case 59:{let i;let{entityReturnState:s}=this,n=this.entity+e.slice(t,this.prevI);this.state=s,""===n?(this.fail("empty entity name."),i="&;"):(i=this.parseEntity(n),this.entity=""),(13!==s||void 0!==this.textHandler)&&(this.text+=i);break t}case -1:this.entity+=e.slice(t);break t}}sOpenWaka(){let t=this.getCode();if(l(t))this.state=34,this.unget(),this.xmlDeclPossible=!1;else switch(t){case 47:this.state=43,this.xmlDeclPossible=!1;break;case 33:this.state=16,this.openWakaBang="",this.xmlDeclPossible=!1;break;case 63:this.state=23;break;default:this.fail("disallowed character in tag name"),this.state=13,this.xmlDeclPossible=!1}}sOpenWakaBang(){switch(this.openWakaBang+=String.fromCodePoint(this.getCodeNorm()),this.openWakaBang){case"[CDATA[":this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0),this.state=20,this.openWakaBang="";break;case"--":this.state=17,this.openWakaBang="";break;case"DOCTYPE":this.state=2,(this.doctype||this.sawRoot)&&this.fail("inappropriately located doctype declaration."),this.openWakaBang="";break;default:this.openWakaBang.length>=7&&this.fail("incorrect syntax.")}}sComment(){this.captureToChar(45)&&(this.state=18)}sCommentEnding(){var t;let e=this.getCodeNorm();45===e?(this.state=19,null===(t=this.commentHandler)||void 0===t||t.call(this,this.text),this.text=""):(this.text+=`-${String.fromCodePoint(e)}`,this.state=17)}sCommentEnded(){let t=this.getCodeNorm();62!==t?(this.fail("malformed comment."),this.text+=`--${String.fromCodePoint(t)}`,this.state=17):this.state=13}sCData(){this.captureToChar(93)&&(this.state=21)}sCDataEnding(){let t=this.getCodeNorm();93===t?this.state=22:(this.text+=`]${String.fromCodePoint(t)}`,this.state=20)}sCDataEnding2(){var t;let e=this.getCodeNorm();switch(e){case 62:null===(t=this.cdataHandler)||void 0===t||t.call(this,this.text),this.text="",this.state=13;break;case 93:this.text+="]";break;default:this.text+=`]]${String.fromCodePoint(e)}`,this.state=20}}sPIFirstChar(){let t=this.getCodeNorm();this.nameStartCheck(t)?(this.piTarget+=String.fromCodePoint(t),this.state=24):63===t||a(t)?(this.fail("processing instruction without a target."),this.state=63===t?26:25):(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(t),this.state=24)}sPIRest(){let{chunk:t,i:e}=this;for(;;){let i=this.getCodeNorm();if(-1===i){this.piTarget+=t.slice(e);return}if(!this.nameCheck(i)){this.piTarget+=t.slice(e,this.prevI);let s=63===i;s||a(i)?"xml"===this.piTarget?(this.xmlDeclPossible||this.fail("an XML declaration must be at the start of the document."),this.state=s?33:27):this.state=s?26:25:(this.fail("disallowed character in processing instruction name."),this.piTarget+=String.fromCodePoint(i));break}}}sPIBody(){if(0===this.text.length){let t=this.getCodeNorm();63===t?this.state=26:a(t)||(this.text=String.fromCodePoint(t))}else this.captureToChar(63)&&(this.state=26)}sPIEnding(){var t;let e=this.getCodeNorm();if(62===e){let{piTarget:e}=this;"xml"===e.toLowerCase()&&this.fail("the XML declaration must appear at the start of the document."),null===(t=this.piHandler)||void 0===t||t.call(this,{target:e,body:this.text}),this.piTarget=this.text="",this.state=13}else 63===e?this.text+="?":(this.text+=`?${String.fromCodePoint(e)}`,this.state=25);this.xmlDeclPossible=!1}sXMLDeclNameStart(){let t=this.skipSpaces();if(63===t){this.state=33;return}-1!==t&&(this.state=28,this.name=String.fromCodePoint(t))}sXMLDeclName(){let t=this.captureTo(M);if(63===t){this.state=33,this.name+=this.text,this.text="",this.fail("XML declaration is incomplete.");return}if(a(t)||61===t){if(this.name+=this.text,this.text="",!this.xmlDeclExpects.includes(this.name))switch(this.name.length){case 0:this.fail("did not expect any more name/value pairs.");break;case 1:this.fail(`expected the name ${this.xmlDeclExpects[0]}.`);break;default:this.fail(`expected one of ${this.xmlDeclExpects.join(", ")}`)}this.state=61===t?30:29}}sXMLDeclEq(){let t=this.getCodeNorm();if(63===t){this.state=33,this.fail("XML declaration is incomplete.");return}a(t)||(61!==t&&this.fail("value required."),this.state=30)}sXMLDeclValueStart(){let t=this.getCodeNorm();if(63===t){this.state=33,this.fail("XML declaration is incomplete.");return}a(t)||(C(t)?this.q=t:(this.fail("value must be quoted."),this.q=32),this.state=31)}sXMLDeclValue(){let t=this.captureTo([this.q,63]);if(63===t){this.state=33,this.text="",this.fail("XML declaration is incomplete.");return}if(-1===t)return;let e=this.text;switch(this.text="",this.name){case"version":this.xmlDeclExpects=["encoding","standalone"],this.xmlDecl.version=e,/^1\.[0-9]+$/.test(e)?this.opt.forceXMLVersion||this.setXMLVersion(e):this.fail("version number must match /^1\\.[0-9]+$/.");break;case"encoding":/^[A-Za-z][A-Za-z0-9._-]*$/.test(e)||this.fail("encoding value must match /^[A-Za-z0-9][A-Za-z0-9._-]*$/."),this.xmlDeclExpects=["standalone"],this.xmlDecl.encoding=e;break;case"standalone":"yes"!==e&&"no"!==e&&this.fail('standalone value must match "yes" or "no".'),this.xmlDeclExpects=[],this.xmlDecl.standalone=e}this.name="",this.state=32}sXMLDeclSeparator(){let t=this.getCodeNorm();if(63===t){this.state=33;return}a(t)||(this.fail("whitespace required."),this.unget()),this.state=27}sXMLDeclEnding(){var t;62===this.getCodeNorm()?("xml"!==this.piTarget?this.fail("processing instructions are not allowed before root."):"version"!==this.name&&this.xmlDeclExpects.includes("version")&&this.fail("XML declaration must contain a version."),null===(t=this.xmldeclHandler)||void 0===t||t.call(this,this.xmlDecl),this.name="",this.piTarget=this.text="",this.state=13):this.fail("The character ? is disallowed anywhere in XML declarations."),this.xmlDeclPossible=!1}sOpenTag(){var t;let e=this.captureNameChars();if(-1===e)return;let i=this.tag={name:this.name,attributes:Object.create(null)};switch(this.name="",this.xmlnsOpt&&(this.topNS=i.ns=Object.create(null)),null===(t=this.openTagStartHandler)||void 0===t||t.call(this,i),this.sawRoot=!0,!this.fragmentOpt&&this.closedRoot&&this.fail("documents may contain only one root."),e){case 62:this.openTag();break;case 47:this.state=35;break;default:a(e)||this.fail("disallowed character in tag name."),this.state=36}}sOpenTagSlash(){62===this.getCode()?this.openSelfClosingTag():(this.fail("forward-slash in opening tag not followed by >."),this.state=36)}sAttrib(){let t=this.skipSpaces();-1!==t&&(l(t)?(this.unget(),this.state=37):62===t?this.openTag():47===t?this.state=35:this.fail("disallowed character in attribute name."))}sAttribName(){let t=this.captureNameChars();61===t?this.state=39:a(t)?this.state=38:62===t?(this.fail("attribute without value."),this.pushAttrib(this.name,this.name),this.name=this.text="",this.openTag()):-1!==t&&this.fail("disallowed character in attribute name.")}sAttribNameSawWhite(){let t=this.skipSpaces();switch(t){case -1:return;case 61:this.state=39;break;default:this.fail("attribute without value."),this.text="",this.name="",62===t?this.openTag():l(t)?(this.unget(),this.state=37):(this.fail("disallowed character in attribute name."),this.state=36)}}sAttribValue(){let t=this.getCodeNorm();C(t)?(this.q=t,this.state=40):a(t)||(this.fail("unquoted attribute value."),this.state=42,this.unget())}sAttribValueQuoted(){let{q:t,chunk:e}=this,{i:i}=this;for(;;)switch(this.getCode()){case t:this.pushAttrib(this.name,this.text+e.slice(i,this.prevI)),this.name=this.text="",this.q=null,this.state=41;return;case 38:this.text+=e.slice(i,this.prevI),this.state=14,this.entityReturnState=40;return;case 10:case -2:case 9:this.text+=`${e.slice(i,this.prevI)} `,i=this.i;break;case 60:this.text+=e.slice(i,this.prevI),this.fail("disallowed character.");return;case -1:this.text+=e.slice(i);return}}sAttribValueClosed(){let t=this.getCodeNorm();a(t)?this.state=36:62===t?this.openTag():47===t?this.state=35:l(t)?(this.fail("no whitespace between attributes."),this.unget(),this.state=37):this.fail("disallowed character in attribute name.")}sAttribValueUnquoted(){let t=this.captureTo(S);switch(t){case 38:this.state=14,this.entityReturnState=42;break;case 60:this.fail("disallowed character.");break;case -1:break;default:this.text.includes("]]>")&&this.fail('the string "]]>" is disallowed in char data.'),this.pushAttrib(this.name,this.text),this.name=this.text="",62===t?this.openTag():this.state=36}}sCloseTag(){let t=this.captureNameChars();62===t?this.closeTag():a(t)?this.state=44:-1!==t&&this.fail("disallowed character in closing tag.")}sCloseTagSawWhite(){switch(this.skipSpaces()){case 62:this.closeTag();break;case -1:break;default:this.fail("disallowed character in closing tag.")}}handleTextInRoot(){let{i:t,forbiddenState:e}=this,{chunk:i,textHandler:s}=this;e:for(;;)switch(this.getCode()){case 60:if(this.state=15,void 0!==s){let{text:e}=this,n=i.slice(t,this.prevI);0!==e.length?(s(e+n),this.text=""):0!==n.length&&s(n)}e=0;break e;case 38:this.state=14,this.entityReturnState=13,void 0!==s&&(this.text+=i.slice(t,this.prevI)),e=0;break e;case 93:switch(e){case 0:e=1;break;case 1:e=2;break;case 2:break;default:throw Error("impossible state")}break;case 62:2===e&&this.fail('the string "]]>" is disallowed in char data.'),e=0;break;case -2:void 0!==s&&(this.text+=`${i.slice(t,this.prevI)}
`),t=this.i,e=0;break;case -1:void 0!==s&&(this.text+=i.slice(t));break e;default:e=0}this.forbiddenState=e}handleTextOutsideRoot(){let{i:t}=this,{chunk:e,textHandler:i}=this,s=!1;i:for(;;){let n=this.getCode();switch(n){case 60:if(this.state=15,void 0!==i){let{text:s}=this,n=e.slice(t,this.prevI);0!==s.length?(i(s+n),this.text=""):0!==n.length&&i(n)}break i;case 38:this.state=14,this.entityReturnState=13,void 0!==i&&(this.text+=e.slice(t,this.prevI)),s=!0;break i;case -2:void 0!==i&&(this.text+=`${e.slice(t,this.prevI)}
`),t=this.i;break;case -1:void 0!==i&&(this.text+=e.slice(t));break i;default:a(n)||(s=!0)}}s&&(this.sawRoot||this.reportedTextBeforeRoot||(this.fail("text data outside of root node."),this.reportedTextBeforeRoot=!0),this.closedRoot&&!this.reportedTextAfterRoot&&(this.fail("text data outside of root node."),this.reportedTextAfterRoot=!0))}pushAttribNS(t,e){var i;let{prefix:s,local:n}=this.qname(t),r={name:t,prefix:s,local:n,value:e};if(this.attribList.push(r),null===(i=this.attributeHandler)||void 0===i||i.call(this,r),"xmlns"===s){let t=e.trim();"1.0"===this.currentXMLVersion&&""===t&&this.fail("invalid attempt to undefine prefix in XML 1.0"),this.topNS[n]=t,w(this,n,t)}else if("xmlns"===t){let t=e.trim();this.topNS[""]=t,w(this,"",t)}}pushAttribPlain(t,e){var i;let s={name:t,value:e};this.attribList.push(s),null===(i=this.attributeHandler)||void 0===i||i.call(this,s)}end(){var t,e;this.sawRoot||this.fail("document must contain a root element.");let{tags:i}=this;for(;i.length>0;){let t=i.pop();this.fail(`unclosed tag: ${t.name}`)}0!==this.state&&13!==this.state&&this.fail("unexpected end.");let{text:s}=this;return 0!==s.length&&(null===(t=this.textHandler)||void 0===t||t.call(this,s),this.text=""),this._closed=!0,null===(e=this.endHandler)||void 0===e||e.call(this),this._init(),this}resolve(t){var e,i;let s=this.topNS[t];if(void 0!==s)return s;let{tags:n}=this;for(let e=n.length-1;e>=0;e--)if(void 0!==(s=n[e].ns[t]))return s;return void 0!==(s=this.ns[t])?s:null===(i=(e=this.opt).resolvePrefix)||void 0===i?void 0:i.call(e,t)}qname(t){let e=t.indexOf(":");if(-1===e)return{prefix:"",local:t};let i=t.slice(e+1),s=t.slice(0,e);return(""===s||""===i||i.includes(":"))&&this.fail(`malformed name: ${t}.`),{prefix:s,local:i}}processAttribsNS(){var t;let{attribList:e}=this,i=this.tag;{let{prefix:e,local:s}=this.qname(i.name);i.prefix=e,i.local=s;let n=i.uri=null!==(t=this.resolve(e))&&void 0!==t?t:"";""!==e&&("xmlns"===e&&this.fail('tags may not have "xmlns" as prefix.'),""===n&&(this.fail(`unbound namespace prefix: ${JSON.stringify(e)}.`),i.uri=e))}if(0===e.length)return;let{attributes:s}=i,n=new Set;for(let t of e){let e,i;let{name:r,prefix:a,local:o}=t;""===a?(e="xmlns"===r?f:"",i=r):(void 0===(e=this.resolve(a))&&(this.fail(`unbound namespace prefix: ${JSON.stringify(a)}.`),e=a),i=`{${e}}${o}`),n.has(i)&&this.fail(`duplicate attribute: ${i}.`),n.add(i),t.uri=e,s[r]=t}this.attribList=[]}processAttribsPlain(){let{attribList:t}=this,e=this.tag.attributes;for(let{name:i,value:s}of t)void 0!==e[i]&&this.fail(`duplicate attribute: ${i}.`),e[i]=s;this.attribList=[]}openTag(){var t;this.processAttribs();let{tags:e}=this,i=this.tag;i.isSelfClosing=!1,null===(t=this.openTagHandler)||void 0===t||t.call(this,i),e.push(i),this.state=13,this.name=""}openSelfClosingTag(){var t,e,i;this.processAttribs();let{tags:s}=this,n=this.tag;n.isSelfClosing=!0,null===(t=this.openTagHandler)||void 0===t||t.call(this,n),null===(e=this.closeTagHandler)||void 0===e||e.call(this,n),null===(this.tag=null!==(i=s[s.length-1])&&void 0!==i?i:null)&&(this.closedRoot=!0),this.state=13,this.name=""}closeTag(){let{tags:t,name:e}=this;if(this.state=13,this.name="",""===e){this.fail("weird empty close tag."),this.text+="</>";return}let i=this.closeTagHandler,s=t.length;for(;s-- >0;){let s=this.tag=t.pop();if(this.topNS=s.ns,null==i||i(s),s.name===e)break;this.fail("unexpected close tag.")}0===s?this.closedRoot=!0:s<0&&(this.fail(`unmatched closing tag: ${e}.`),this.text+=`</${e}>`)}parseEntity(t){if("#"!==t[0]){let e=this.ENTITIES[t];return void 0!==e?e:(this.fail(this.isName(t)?"undefined entity.":"disallowed character in entity name."),`&${t};`)}let e=NaN;return("x"===t[1]&&/^#x[0-9a-f]+$/i.test(t)?e=parseInt(t.slice(2),16):/^#[0-9]+$/.test(t)&&(e=parseInt(t.slice(1),10)),this.isChar(e))?String.fromCodePoint(e):(this.fail("malformed character entity."),`&${t};`)}}e.SaxesParser=U},345:(t,e)=>{"use strict";function i(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="	\n\r -퟿-�\uD800\uDC00-\uDBFF\uDFFF",e.S=" 	\r\n",e.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�\uD800\uDC00-\uDB7F\uDFFF",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9\xb7̀-ͯ‿-⁀",e.CHAR_RE=RegExp("^["+e.CHAR+"]$","u"),e.S_RE=RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(t){return t>=32&&t<=55295||10===t||13===t||9===t||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isS=function(t){return 32===t||10===t||13===t||9===t},e.isNameStartChar=i,e.isNameChar=function(t){return i(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},422:(t,e)=>{"use strict";function i(t){return t>=65&&t<=90||t>=97&&t<=122||58===t||95===t||8204===t||8205===t||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.CHAR="\x01-퟿-�\uD800\uDC00-\uDBFF\uDFFF",e.RESTRICTED_CHAR="\x01-\b\v\f\x0e-\x1f\x7f-\x84\x86-\x9f",e.S=" 	\r\n",e.NAME_START_CHAR=":A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-˿Ͱ-ͽͿ-῿‌‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�\uD800\uDC00-\uDB7F\uDFFF",e.NAME_CHAR="-"+e.NAME_START_CHAR+".0-9\xb7̀-ͯ‿-⁀",e.CHAR_RE=RegExp("^["+e.CHAR+"]$","u"),e.RESTRICTED_CHAR_RE=RegExp("^["+e.RESTRICTED_CHAR+"]$","u"),e.S_RE=RegExp("^["+e.S+"]+$","u"),e.NAME_START_CHAR_RE=RegExp("^["+e.NAME_START_CHAR+"]$","u"),e.NAME_CHAR_RE=RegExp("^["+e.NAME_CHAR+"]$","u"),e.NAME_RE=RegExp("^["+e.NAME_START_CHAR+"]["+e.NAME_CHAR+"]*$","u"),e.NMTOKEN_RE=RegExp("^["+e.NAME_CHAR+"]+$","u"),e.S_LIST=[32,10,13,9],e.isChar=function(t){return t>=1&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isRestrictedChar=function(t){return t>=1&&t<=8||11===t||12===t||t>=14&&t<=31||t>=127&&t<=132||t>=134&&t<=159},e.isCharAndNotRestricted=function(t){return 9===t||10===t||13===t||t>31&&t<127||133===t||t>159&&t<=55295||t>=57344&&t<=65533||t>=65536&&t<=1114111},e.isS=function(t){return 32===t||10===t||13===t||9===t},e.isNameStartChar=i,e.isNameChar=function(t){return i(t)||t>=48&&t<=57||45===t||46===t||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},9628:(t,e)=>{"use strict";function i(t){return t>=65&&t<=90||95===t||t>=97&&t<=122||t>=192&&t<=214||t>=216&&t<=246||t>=248&&t<=767||t>=880&&t<=893||t>=895&&t<=8191||t>=8204&&t<=8205||t>=8304&&t<=8591||t>=11264&&t<=12271||t>=12289&&t<=55295||t>=63744&&t<=64975||t>=65008&&t<=65533||t>=65536&&t<=983039}Object.defineProperty(e,"__esModule",{value:!0}),e.NC_NAME_START_CHAR="A-Z_a-z\xc0-\xd6\xd8-\xf6\xf8-˿Ͱ-ͽͿ-῿‌-‍⁰-↏Ⰰ-⿯、-퟿豈-﷏ﷰ-�\uD800\uDC00-\uDB7F\uDFFF",e.NC_NAME_CHAR="-"+e.NC_NAME_START_CHAR+".0-9\xb7̀-ͯ‿-⁀",e.NC_NAME_START_CHAR_RE=RegExp("^["+e.NC_NAME_START_CHAR+"]$","u"),e.NC_NAME_CHAR_RE=RegExp("^["+e.NC_NAME_CHAR+"]$","u"),e.NC_NAME_RE=RegExp("^["+e.NC_NAME_START_CHAR+"]["+e.NC_NAME_CHAR+"]*$","u"),e.isNCNameStartChar=i,e.isNCNameChar=function(t){return i(t)||45===t||46===t||t>=48&&t<=57||183===t||t>=768&&t<=879||t>=8255&&t<=8256}},8878:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Ucum=void 0,e.Ucum={dimLen_:7,validOps_:[".","/"],codeSep_:": ",valMsgStart_:"Did you mean ",valMsgEnd_:"?",cnvMsgStart_:"We assumed you meant ",cnvMsgEnd_:".",openEmph_:" ->",closeEmph_:"<- ",openEmphHTML_:' <span class="emphSpan">',closeEmphHTML_:"</span> ",bracesMsg_:"FYI - annotations (text in curly braces {}) are ignored, except that an annotation without a leading symbol implies the default unit 1 (the unity).",needMoleWeightMsg_:"Did you wish to convert between mass and moles?  The molecular weight of the substance represented by the units is required to perform the conversion.",needEqWeightMsg_:"Did you wish to convert with equivalents?  The molecular weight of the substance is required to perform the conversion.",needEqChargeMsg_:"Did you wish to convert with equivalents?  The charge of the substance is required to perform the conversion.",csvCols_:{"case-sensitive code":"csCode_","LOINC property":"loincProperty_","name (display)":"name_",synonyms:"synonyms_",source:"source_",category:"category_",Guidance:"guidance_"},inputKey_:"case-sensitive code",specUnits_:{"B[10.nV]":"specialUnitOne","[m/s2/Hz^(1/2)]":"specialUnitTwo"}}},3978:(t,e,i)=>{"use strict";e.R=void 0;var s=i(8878),n=i(6641);class r{constructor(t){if(0===s.Ucum.dimLen_)throw Error("Dimension.setDimensionLen must be called before Dimension constructor");if(null==t)this.assignZero();else if(t instanceof Array){if(t.length!==s.Ucum.dimLen_)throw Error(`Parameter error, incorrect length of vector passed to Dimension constructor, vector = ${JSON.stringify(t)}`);this.dimVec_=[];for(let e=0;e<s.Ucum.dimLen_;e++)this.dimVec_.push(t[e])}else if(n(t)){if(t<0||t>=s.Ucum.dimLen_)throw Error("Parameter error, invalid element number specified for Dimension constructor");this.assignZero(),this.dimVec_[t]=1}}setElementAt(t,e){if(!n(t)||t<0||t>=s.Ucum.dimLen_)throw Error(`Dimension.setElementAt called with an invalid index position (${t})`);this.dimVec_||this.assignZero(),null==e&&(e=1),this.dimVec_[t]=e}getElementAt(t){if(!n(t)||t<0||t>=s.Ucum.dimLen_)throw Error(`Dimension.getElementAt called with an invalid index position (${t})`);let e=null;return this.dimVec_&&(e=this.dimVec_[t]),e}getProperty(t){return this["_"===t.charAt(t.length-1)?t:t+"_"]}toString(){let t=null;return this.dimVec_&&(t="["+this.dimVec_.join(", ")+"]"),t}add(t){if(!t instanceof r)throw Error(`Dimension.add called with an invalid parameter - ${typeof t} instead of a Dimension object`);if(this.dimVec_&&t.dimVec_)for(let e=0;e<s.Ucum.dimLen_;e++)this.dimVec_[e]+=t.dimVec_[e];return this}sub(t){if(!t instanceof r)throw Error(`Dimension.sub called with an invalid parameter - ${typeof t} instead of a Dimension object`);if(this.dimVec_&&t.dimVec_)for(let e=0;e<s.Ucum.dimLen_;e++)this.dimVec_[e]-=t.dimVec_[e];return this}minus(){if(this.dimVec_)for(let t=0;t<s.Ucum.dimLen_;t++)this.dimVec_[t]=-this.dimVec_[t];return this}mul(t){if(!n(t))throw Error(`Dimension.sub called with an invalid parameter - ${typeof dim2} instead of a number`);if(this.dimVec_)for(let e=0;e<s.Ucum.dimLen_;e++)this.dimVec_[e]*=t;return this}equals(t){if(!t instanceof r)throw Error(`Dimension.equals called with an invalid parameter - ${typeof t} instead of a Dimension object`);let e=!0,i=t.dimVec_;if(this.dimVec_&&i)for(let t=0;e&&t<s.Ucum.dimLen_;t++)e=this.dimVec_[t]===i[t];else e=null===this.dimVec_&&null===i;return e}assignDim(t){if(!t instanceof r)throw Error(`Dimension.assignDim called with an invalid parameter - ${typeof t} instead of a Dimension object`);if(null===t.dimVec_)this.dimVec_=null;else{null===this.dimVec_&&(this.dimVec_=[]);for(let e=0;e<s.Ucum.dimLen_;e++)this.dimVec_[e]=t.dimVec_[e]}return this}assignZero(){(null===this.dimVec_||void 0===this.dimVec_)&&(this.dimVec_=[]);for(let t=0;t<s.Ucum.dimLen_;t++)this.dimVec_.push(0);return this}isZero(){let t=null!==this.dimVec_;if(this.dimVec_)for(let e=0;t&&e<s.Ucum.dimLen_;e++)t=0===this.dimVec_[e];return t}isNull(){return null===this.dimVec_}clone(){let t=new r;return t.assignDim(this),t}}e.R=r},9943:(t,e)=>{"use strict";e.DP=function(t){let e=t&&t.config;if(e){if(!e.length||!t.data)return t.data;{let s=function(t){return t.map(t=>Array.isArray(t)?t:[t])}(e);return t.data.map(i.bind(null,s))}}return t},Array.prototype.push;function i(t,e){let i={};return t.forEach((t,s)=>{let n=i;for(let e=0;e<t.length-1;e++)n=n[t[e]]=n[t[e]]||{};n[t[t.length-1]]=e[s]}),i}},2184:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Prefix=void 0,i(8878);class s{constructor(t){if(void 0===t.code_||null===t.code_||void 0===t.name_||null===t.name_||void 0===t.value_||null===t.value_||void 0===t.exp_)throw Error("Prefix constructor called missing one or more parameters.  Prefix codes (cs or ci), name, value and exponent must all be specified and all but the exponent must not be null.");this.code_=t.code_,this.ciCode_=t.ciCode_,this.name_=t.name_,this.printSymbol_=t.printSymbol_,"string"==typeof t.value_?this.value_=parseFloat(t.value_):this.value_=t.value_,this.exp_=t.exp_}getValue(){return this.value_}getCode(){return this.code_}getCiCode(){return this.ciCode_}getName(){return this.name_}getPrintSymbol(){return this.printSymbol_}getExp(){return this.exp_}equals(t){return this.code_===t.code_&&this.ciCode_===t.ciCode_&&this.name_===t.name_&&this.printSymbol_===t.printSymbol_&&this.value_===t.value_&&this.exp_===t.exp_}}e.Prefix=s},5298:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.PrefixTables=e.PrefixTablesFactory=void 0;class i{constructor(){this.byCode_={},this.byValue_={}}prefixCount(){return Object.keys(this.byCode_).length}allPrefixesByValue(){let t="",e=Object.keys(this.byValue_),i=e.length;for(let s=0;s<i;s++){let i=this.getPrefixByValue(e[s]);t+=i.code_+","+i.name_+",,"+i.value_+"\r\n"}return t}allPrefixesByCode(){let t=[],e=Object.keys(this.byCode_);e.sort();let i=e.length;for(let s=0;s<i;s++)t.push(this.getPrefixByCode(e[s]));return t}add(t){this.byCode_[t.getCode()]=t,this.byValue_[t.getValue()]=t}isDefined(t){return null!==this.byCode_[t]&&void 0!==this.byCode_[t]}getPrefixByCode(t){return this.byCode_[t]}getPrefixByValue(t){return this.byValue_[t]}}e.PrefixTablesFactory=i;var s=new i;e.PrefixTables={getInstance:function(){return s}}},5864:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;class i{constructor(){this.funcs={},this.funcs.cel={cnvTo:function(t){return t-273.15},cnvFrom:function(t){return t+273.15}},this.funcs.degf={cnvTo:function(t){return t-459.67},cnvFrom:function(t){return t+459.67}},this.funcs.degre={cnvTo:function(t){return t-273.15},cnvFrom:function(t){return t+273.15}},this.funcs.ph={cnvTo:function(t){return-Math.log(t)/Math.LN10},cnvFrom:function(t){return Math.pow(10,-t)}},this.funcs.ln={cnvTo:function(t){return Math.log(t)},cnvFrom:function(t){return Math.exp(t)}},this.funcs["2ln"]={cnvTo:function(t){return 2*Math.log(t)},cnvFrom:function(t){return Math.exp(t/2)}},this.funcs.lg={cnvTo:function(t){return Math.log(t)/Math.LN10},cnvFrom:function(t){return Math.pow(10,t)}},this.funcs["10lg"]={cnvTo:function(t){return 10*Math.log(t)/Math.LN10},cnvFrom:function(t){return Math.pow(10,t/10)}},this.funcs["20lg"]={cnvTo:function(t){return 20*Math.log(t)/Math.LN10},cnvFrom:function(t){return Math.pow(10,t/20)}},this.funcs["2lg"]={cnvTo:function(t){return 2*Math.log(t)/Math.LN10},cnvFrom:function(t){return Math.pow(10,t/2)}},this.funcs.lgtimes2=this.funcs["2lg"],this.funcs.ld={cnvTo:function(t){return Math.log(t)/Math.LN2},cnvFrom:function(t){return Math.pow(2,t)}},this.funcs["100tan"]={cnvTo:function(t){return 100*Math.tan(t)},cnvFrom:function(t){return Math.atan(t/100)}},this.funcs.tanTimes100=this.funcs["100tan"],this.funcs.sqrt={cnvTo:function(t){return Math.sqrt(t)},cnvFrom:function(t){return t*t}},this.funcs.inv={cnvTo:function(t){return 1/t},cnvFrom:function(t){return 1/t}},this.funcs.hpX={cnvTo:function(t){return-this.funcs.lg(t)},cnvFrom:function(t){return Math.pow(10,-t)}},this.funcs.hpC={cnvTo:function(t){return-this.func.ln(t)/this.funcs.ln(100)},cnvFrom:function(t){return Math.pow(100,-t)}},this.funcs.hpM={cnvTo:function(t){return-this.funcs.ln(t)/this.funcs.ln(1e3)},cnvFrom:function(t){return Math.pow(1e3,-t)}},this.funcs.hpQ={cnvTo:function(t){return-this.funcs.ln(t)/this.funcs.ln(5e4)},cnvFrom:function(t){return Math.pow(5e4,-t)}}}forName(t){t=t.toLowerCase();let e=this.funcs[t];if(null===e)throw Error(`Requested function ${t} is not defined`);return e}isDefined(t){return t=t.toLowerCase(),null!==this.funcs[t]}}var s=new i;e.default=s},2291:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.isNumericString=function(t){let e=""+t;return!isNaN(e)&&!isNaN(parseFloat(e))},e.isIntegerUnit=function(t){return/^\d+$/.test(t)},e.getSynonyms=function(t){let e={},i=s.getInstance(),n={};if((n=i.getUnitBySynonym(t)).units){e.status="succeeded";let t=n.units.length;e.units=[];for(let i=0;i<t;i++){let t=n.units[i];e.units[i]={code:t.csCode_,name:t.name_,guidance:t.guidance_}}}else e.status=n.status,e.msg=n.msg;return e};var s=i(9376).UnitTables},3581:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.ucumJsonDefs=e.UcumJsonDefs=void 0;var s=i(2184),n=i(5298),r=i(9944),a=i(9376),o=i(9943).DP;class l{loadJsonDefs(){let t=i(8096);if(t.prefixes=o(t.prefixes),t.units=o(t.units),0===a.UnitTables.getInstance().unitsCount()){let e=n.PrefixTables.getInstance(),i=t.prefixes,o=i.length;for(let t=0;t<o;t++){let n=new s.Prefix(i[t]);e.add(n)}let l=a.UnitTables.getInstance(),h=t.units,u=h.length;for(let t=0;t<u;t++){let e=new r.Unit(h[t]);l.addUnit(e)}}}}e.UcumJsonDefs=l;var h=new l;e.ucumJsonDefs=h},4943:(t,e,i)=>{"use strict";e.n=void 0;var s=i(3581),n=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=r();if(e&&e.has(t))return e.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var a=s?Object.getOwnPropertyDescriptor(t,n):null;a&&(a.get||a.set)?Object.defineProperty(i,n,a):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}(i(2291));function r(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return r=function(){return t},t}var a=i(8878).Ucum,o=i(9376).UnitTables,l=i(1214).T;class h{constructor(){0===o.getInstance().unitsCount()&&s.ucumJsonDefs.loadJsonDefs(),this.uStrParser_=l.getInstance(),this.massDimIndex_=o.getInstance().getMassDimensionIndex()}useHTMLInMessages(t){void 0===t&&(t=!0),this.uStrParser_.useHTMLInMessages(t)}useBraceMsgForEachString(t){void 0===t&&(t=!0),this.uStrParser_.useBraceMsgForEachString(t)}validateUnitString(t,e,i){void 0===e&&(e=!1),void 0===i&&(i="validate");let s=this.getSpecifiedUnit(t,i,e),n=s.unit,r=n?{ucumCode:s.origString,unit:{code:n.csCode_,name:n.name_,guidance:n.guidance_}}:{ucumCode:null};return r.status=s.status,s.suggestions&&(r.suggestions=s.suggestions),r.msg=s.retMsg,r}detectConversionType(t,e){return t.moleExp_==e.moleExp_&&t.equivalentExp_==e.equivalentExp_?"normal":t.equivalentExp_==e.equivalentExp_?"mol|mass":t.moleExp_==e.moleExp_?"eq|mass":t.dim_.getElementAt(this.massDimIndex_)==e.dim_.getElementAt(this.massDimIndex_)?"eq|mol":"eq|mol|mass"}convertUnitTo(t,e,i,s={}){let{suggest:n=!1,molecularWeight:r=null,charge:o=null}=s,l={status:"failed",toVal:null,msg:[]};if(t&&(t=t.trim()),t&&""!=t||(l.status="error",l.msg.push('No "from" unit expression specified.')),this._checkFromVal(e,l),i&&(i=i.trim()),i&&""!=i||(l.status="error",l.msg.push('No "to" unit expression specified.')),"error"!==l.status){let s=null,h=this.getSpecifiedUnit(t,"convert",n);s=h.unit,h.retMsg&&(l.msg=l.msg.concat(h.retMsg)),h.suggestions&&(l.suggestions={},l.suggestions.from=h.suggestions),s||l.msg.push(`Unable to find a unit for ${t}, so no conversion could be performed.`);let u=null;if(u=(h=this.getSpecifiedUnit(i,"convert",n)).unit,h.retMsg&&(l.msg=l.msg.concat(h.retMsg)),h.suggestions&&(l.suggestions||(l.suggestions={}),l.suggestions.to=h.suggestions),u||l.msg.push(`Unable to find a unit for ${i}, so no conversion could be performed.`),s&&u){let n=this.detectConversionType(s,u),h=l.msg.length;switch(n){case"normal":try{l.toVal=u.convertFrom(e,s)}catch(t){l.msg.push(t.message)}break;case"mol|mass":if(!s.isMolMassCommensurable(u)){l.msg.push(`Sorry.  ${t} cannot be converted to ${i}.`);break}if(!r){l.msg.push(a.needMoleWeightMsg_);break}l.toVal=s.convertMolMass(e,u,r);break;case"eq|mass":if(!s.isEqMassCommensurable(u)){l.msg.push(`Sorry.  ${t} cannot be converted to ${i}.`);break}r||l.msg.push(a.needEqWeightMsg_),o||l.msg.push(a.needEqChargeMsg_),l.msg.length||(l.toVal=s.convertEqMass(e,u,r,o));break;case"eq|mol":if(!s.isEqMolCommensurable(u)){l.msg.push(`Sorry.  ${t} cannot be converted to ${i}.`);break}if(!o){l.msg.push(a.needEqChargeMsg_);break}l.toVal=s.convertEqMol(e,u,o);break;case"eq|mol|mass":if(!s.isEqMolMassCommensurable(u)){l.msg.push(`Sorry.  ${t} cannot be converted to ${i}.`);break}r||l.msg.push(a.needEqWeightMsg_),o||l.msg.push(a.needEqChargeMsg_),l.msg.length||(l.toVal=s.convertEqMolMass(e,u,r,o));break;default:l.msg.push("Unknown conversion type.  No conversion was attempted.")}l.msg.length>h?l.status="failed":(l.status="succeeded",l.fromUnit=s,l.toUnit=u)}}return l}convertToBaseUnits(t,e){let i={};if(this._checkFromVal(e,i),!i.status){let s=this.getSpecifiedUnit(t,"validate");i={status:"valid"==s.status?"succeeded":s.status};let n=s.unit;if(i.msg=s.retMsg||[],n){if(n.isArbitrary_)i.msg.push("Arbitrary units cannot be converted to base units or other units."),i.status="failed";else if("succeeded"==i.status){let t={},s=n.dim_?.dimVec_,r="1";if(s){let e=o.getInstance().dimVecIndexToBaseUnit_;for(let i=0,n=s.length;i<n;++i){let n=s[i];n&&(t[e[i]]=n,r+="."+e[i]+n)}}let a=this.getSpecifiedUnit(r,"validate"),l=a.unit;if("valid"!==a.status)i.msg.push("Unable construct base unit string; tried "+r),i.status="error";else{try{i.magnitude=l.convertFrom(e,n)}catch(t){i.msg.push(t.toString()),i.status="error"}"succeeded"==i.status&&(i.unitToExp=t,i.fromUnitIsSpecial=n.isSpecial_)}}}else s.retMsg?.length==0&&i.msg.push("Could not find unit information for "+t)}return i}_checkFromVal(t,e){(null===t||isNaN(t)||"number"!=typeof t&&!n.isNumericString(t))&&(e.status="error",e.msg||(e.msg=[]),e.msg.push('No "from" value, or an invalid "from" value, was specified.'))}checkSynonyms(t){let e={};return null==t?(e.status="error",e.msg="No term specified for synonym search."):e=n.getSynonyms(t),e}getSpecifiedUnit(t,e,i){void 0===i&&(i=!1);let s={};if(s.retMsg=[],t){let n=o.getInstance();t=t.trim();let r=n.getUnitByCode(t);if(r)s.unit=r,s.origString=t;else try{let n=this.uStrParser_.parseString(t,e,i);s.unit=n[0],s.origString=n[1],n[2]&&(s.retMsg=n[2]),s.suggestions=n[3]}catch(e){console.log(`Unit requested for unit string ${t}.request unsuccessful; error thrown = `+e.message),s.retMsg.unshift(`${t} is not a valid unit.  ${e.message}`)}}else s.retMsg.push("No unit string specified.");return s.unit?s.status=s.origString===t?"valid":"invalid":s.status=s.origString?"invalid":"error",s}commensurablesList(t,e=null){let i=[],s=null,n=this.getSpecifiedUnit(t,"validate",!1),r=n.unit;if(n.retMsg.length>0&&(i=n.retMsg),r){let n=null,a=r.getProperty("dim_");if(a){try{n=a.getProperty("dimVec_")}catch(t){i.push(t.message),"Dimension does not have requested property(dimVec_)"===t.message&&(n=null)}n&&(s=o.getInstance().getUnitsByDimension(n),e&&(s=s.filter(t=>-1!==e.indexOf(t.category_))))}else i.push("No commensurable units were found for "+t)}else i.push(`Could not find unit ${t}.`);return[s,i]}}e.n=h,h.getInstance=function(){return new h}},2771:(t,e,i)=>{"use strict";e.ng=void 0,i(8878).Ucum;var s=i(4943).n;e.ng=s,i(9376).UnitTables},9944:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Unit=void 0;var s,n=function(t){return t&&t.__esModule?t:{default:t}}(i(5864)),r=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=a();if(e&&e.has(t))return e.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=s?Object.getOwnPropertyDescriptor(t,n):null;r&&(r.get||r.set)?Object.defineProperty(i,n,r):i[n]=t[n]}return i.default=t,e&&e.set(t,i),i}(i(2291));function a(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return a=function(){return t},t}var o=i(8878).Ucum,l=i(3978).R,h=i(6641);class u{constructor(t={}){this.isBase_=t.isBase_||!1,this.name_=t.name_||"",this.csCode_=t.csCode_||"",this.ciCode_=t.ciCode_||"",this.property_=t.property_||"",this.magnitude_=t.magnitude_||1,void 0===t.dim_||null===t.dim_?this.dim_=new l:void 0!==t.dim_.dimVec_?this.dim_=new l(t.dim_.dimVec_):t.dim_ instanceof l?this.dim_=t.dim_:t.dim_ instanceof Array||h(t.dim_)?this.dim_=new l(t.dim_):this.dim_=new l,this.printSymbol_=t.printSymbol_||null,this.class_=t.class_||null,this.isMetric_=t.isMetric_||!1,this.variable_=t.variable_||null,this.cnv_=t.cnv_||null,this.cnvPfx_=t.cnvPfx_||1,this.isSpecial_=t.isSpecial_||!1,this.isArbitrary_=t.isArbitrary_||!1,this.moleExp_=t.moleExp_||0,this.equivalentExp_=t.equivalentExp_||0,this.synonyms_=t.synonyms_||null,this.source_=t.source_||null,this.loincProperty_=t.loincProperty_||null,this.category_=t.category_||null,this.guidance_=t.guidance_||null,this.csUnitString_=t.csUnitString_||null,this.ciUnitString_=t.ciUnitString_||null,this.baseFactorStr_=t.baseFactorStr_||null,this.baseFactor_=t.baseFactor_||null,this.defError_=t.defError_||!1}assignUnity(){return this.name_="",this.magnitude_=1,this.dim_||(this.dim_=new l),this.dim_.assignZero(),this.cnv_=null,this.cnvPfx_=1,this}assignVals(t){for(let e in t){let i=(e.charAt(e.length-1),e);if(this.hasOwnProperty(i))this[i]=t[e];else throw Error(`Parameter error; ${e} is not a property of a Unit`)}}clone(){let t=new u;return Object.getOwnPropertyNames(this).forEach(e=>{"dim_"===e?this.dim_?t.dim_=this.dim_.clone():t.dim_=null:t[e]=this[e]}),t}assign(t){Object.getOwnPropertyNames(t).forEach(e=>{"dim_"===e?t.dim_?this.dim_=t.dim_.clone():this.dim_=null:this[e]=t[e]})}equals(t){return this.magnitude_===t.magnitude_&&this.cnv_===t.cnv_&&this.cnvPfx_===t.cnvPfx_&&(null===this.dim_&&null===t.dim_||this.dim_.equals(t.dim_))}fullEquals(t){let e=Object.keys(this).sort(),i=Object.keys(t).sort(),s=e.length,n=s===i.length;for(let r=0;r<s&&n;r++)n=e[r]===i[r]&&("dim_"===e[r]?this.dim_.equals(t.dim_):this[e[r]]===t[e[r]]);return n}getProperty(t){return this["_"===t.charAt(t.length-1)?t:t+"_"]}convertFrom(t,e){let i;if(this.isArbitrary_)throw Error(`Attempt to convert to arbitrary unit "${this.csCode_}"`);if(e.isArbitrary_)throw Error(`Attempt to convert arbitrary unit "${e.csCode_}"`);if(e.dim_&&this.dim_&&!e.dim_.equals(this.dim_)){if(this.isMolMassCommensurable(e))throw Error(o.needMoleWeightMsg_);throw Error(`Sorry.  ${e.csCode_} cannot be converted to ${this.csCode_}.`)}if(e.dim_&&(!this.dim_||this.dim_.isNull())||this.dim_&&(!e.dim_||e.dim_.isNull()))throw Error(`Sorry.  ${e.csCode_} cannot be converted to ${this.csCode_}.`);let s=e.cnv_,r=e.magnitude_;return i=null!=s?n.default.forName(s).cnvFrom(t*e.cnvPfx_)*r:t*r,null!=this.cnv_?n.default.forName(this.cnv_).cnvTo(i/this.magnitude_)/this.cnvPfx_:i/this.magnitude_}convertTo(t,e){return e.convertFrom(t,this)}convertCoherent(t){return null!==this.cnv_&&(t=this.cnv_.f_from(t/this.cnvPfx_)*this.magnitude_),t}mutateCoherent(t){t=this.convertCoherent(t),this.magnitude_=1,this.cnv_=null,this.cnvPfx_=1,this.name_="";for(let t=0,e=l.getMax();t<e;t++){let e=this.dim_.getElementAt(t),i=this._getUnitTables().getUnitsByDimension(new l(t));if(null==i)throw Error(`Can't find base unit for dimension ${t}`);this.name_=i.name+e}return t}convertMolMass(t,e,i){let s=this.moleExp_-e.moleExp_,n=Math.pow(i/this._getUnitTables().getUnitByCode("mol").magnitude_,s);return this.magnitude_/e.magnitude_*n*t}convertEqMass(t,e,i,s){let n=e.equivalentExp_-this.equivalentExp_,r=this._getUnitTables().getUnitByCode("mol").magnitude_;return this.magnitude_*t/Math.pow(i/s,n)/(e.magnitude_/Math.pow(r,n))}convertEqMolMass(t,e,i,s){let n=t/Math.pow(s,this.equivalentExp_-e.equivalentExp_),r=this._getUnitTables(),a=r.getMassDimensionIndex(),o=this.dim_.getElementAt(a)-e.dim_.getElementAt(a),l=Math.pow(i/r.getUnitByCode("mol").magnitude_,-o);return this.magnitude_/e.magnitude_*l*n}isEquivalentUnit(){return 0!==this.equivalentExp_}isMolarUnit(){return 0!==this.moleExp_}convertEqMol(t,e,i){let s=this.equivalentExp_-e.equivalentExp_;return t*(this.magnitude_/e.magnitude_)/Math.pow(i,s)}mutateRatio(t){return null==this.cnv_?this.mutateCoherent(t):t}multiplyThis(t){let e=this.clone();null!=e.cnv_?e.cnvPfx_*=t:e.magnitude_*=t;let i=t.toString();return e.name_=this._concatStrs(i,"*",this.name_,"[","]"),e.csCode_=this._concatStrs(i,".",this.csCode_,"(",")"),e.ciCode_=this._concatStrs(i,".",this.ciCode_,"(",")"),e.printSymbol_=this._concatStrs(i,".",this.printSymbol_,"(",")"),e}multiplyThese(t){var e=this.clone();if(null!=e.cnv_){if(null==t.cnv_&&(!t.dim_||t.dim_.isZero()))e.cnvPfx_*=t.magnitude_;else throw Error(`Attempt to multiply non-ratio unit ${e.name_} failed.`)}else if(null!=t.cnv_){if(!e.dim_||e.dim_.isZero())e.cnvPfx_=t.cnvPfx_*e.magnitude_,e.magnitude_=t.magnitude_,e.cnv_=t.cnv_;else throw Error(`Attempt to multiply non-ratio unit ${t.name_}`)}else e.magnitude_*=t.magnitude_;return e.dim_&&(!e.dim_||e.dim_.dimVec_)?t.dim_&&t.dim_ instanceof l&&e.dim_.add(t.dim_):t.dim_?e.dim_=t.dim_.clone():e.dim_=t.dim_,e.equivalentExp_+=t.equivalentExp_,e.moleExp_+=t.moleExp_,e.name_=this._concatStrs(e.name_,"*",t.name_,"[","]"),e.csCode_=this._concatStrs(e.csCode_,".",t.csCode_,"(",")"),e.ciCode_&&t.ciCode_?e.ciCode_=this._concatStrs(e.ciCode_,".",t.ciCode_,"(",")"):t.ciCode_&&(e.ciCode_=t.ciCode_),e.resetFieldsForDerivedUnit(),e.printSymbol_&&t.printSymbol_?e.printSymbol_=this._concatStrs(e.printSymbol_,".",t.printSymbol_,"(",")"):t.printSymbol_&&(e.printSymbol_=t.printSymbol_),e.isArbitrary_||(e.isArbitrary_=t.isArbitrary_),e.isSpecial_||(e.isSpecial_=t.isSpecial_),e}resetFieldsForDerivedUnit(){this.guidance_="",this.synonyms_=null,this.isBase_=!1}divide(t){var e=this.clone();if(null!=e.cnv_)throw Error(`Attempt to divide non-ratio unit ${e.name_}`);if(null!=t.cnv_)throw Error(`Attempt to divide by non-ratio unit ${t.name_}`);return e.name_&&t.name_?e.name_=this._concatStrs(e.name_,"/",t.name_,"[","]"):t.name_&&(e.name_=t.invertString(t.name_)),e.csCode_=this._concatStrs(e.csCode_,"/",t.csCode_,"(",")"),e.ciCode_&&t.ciCode_?e.ciCode_=this._concatStrs(e.ciCode_,"/",t.ciCode_,"(",")"):t.ciCode_&&(e.ciCode_=t.invertString(t.ciCode_)),e.resetFieldsForDerivedUnit(),e.magnitude_/=t.magnitude_,e.printSymbol_&&t.printSymbol_?e.printSymbol_=this._concatStrs(e.printSymbol_,"/",t.printSymbol_,"(",")"):t.printSymbol_&&(e.printSymbol_=t.invertString(t.printSymbol_)),t.dim_&&(e.dim_?(e.dim_.isNull()&&e.dim_.assignZero(),e.dim_=e.dim_.sub(t.dim_)):e.dim_=t.dim_.clone().minus()),e.moleExp_-=t.moleExp_,e.equivalentExp_-=t.equivalentExp_,e.isArbitrary_||(e.isArbitrary_=t.isArbitrary_),e}invert(){var t=this.clone();if(null!=this.cnv_)throw Error(`Attempt to invert a non-ratio unit - ${this.name_}`);return t.name_=this.invertString(this.name_),t.magnitude_=1/this.magnitude_,t.dim_.minus(),t.equivalentExp_=-this.equivalentExp_,t.moleExp_=-this.moleExp_,t}invertString(t){if(t.length>0){let e=t.replace("/","!").replace(".","/").replace("<!","</").replace("!",".");switch(e.charAt(0)){case".":t=e.substr(1);break;case"/":t=e;break;default:t="/"+e}}return t}_concatStrs(t,e,i,s,n){return this._buildOneString(t,s,n)+e+this._buildOneString(i,s,n)}_buildOneString(t,e,i){return r.isNumericString(t)?t:"("===t.charAt(0)&&t.endsWith(")")||"["===t.charAt(0)&&t.endsWith("]")?t:/[./* ]/.test(t)?e+t+i:t}power(t){if(null!=this.cnv_)throw Error(`Attempt to raise a non-ratio unit, ${this.name_}, to a power.`);var e=this.clone();let i=this.csCode_.match(/([./]|[^./]+)/g),s=i.length;for(let e=0;e<s;e++){let s=i[e];if("/"!==s&&"."!==s){let n=parseInt(s);if(h(n))i[e]=Math.pow(n,t).toString();else{let n=s.length;for(let r=n-1;r>=0;r--)if(!h(parseInt(s[r]))){if(("-"===s[r]||"+"===s[r])&&r--,r<n-1){let n=parseInt(s.substr(r));n=Math.pow(n,t),i[e]=s.substr(0,r)+n.toString(),r=-1}else i[e]+=t.toString(),r=-1;r=-1}}}}return e.csCode_=i.join(""),e.magnitude_=Math.pow(this.magnitude_,t),e.dim_&&e.dim_.mul(t),e.equivalentExp_*=t,e.moleExp_*=t,e}isMolMassCommensurable(t){let e=this._getUnitTables().getMassDimensionIndex(),i=this.dim_.clone();i.setElementAt(e,i.getElementAt(e)+this.moleExp_);let s=t.dim_.clone();return s.setElementAt(e,s.getElementAt(e)+t.moleExp_),i.equals(s)}isEqMassCommensurable(t){let e=this._getUnitTables().getMassDimensionIndex(),i=this.dim_.clone();i.setElementAt(e,i.getElementAt(e)+this.equivalentExp_);let s=t.dim_.clone();return s.setElementAt(e,s.getElementAt(e)+t.equivalentExp_),i.equals(s)}isEqMolCommensurable(t){return this.equivalentExp_+this.moleExp_==t.equivalentExp_+t.moleExp_&&this.dim_.equals(t.dim_)}isEqMolMassCommensurable(t){let e=this._getUnitTables().getMassDimensionIndex(),i=this.dim_.clone();i.setElementAt(e,i.getElementAt(e)+this.equivalentExp_+this.moleExp_);let s=t.dim_.clone();return s.setElementAt(e,s.getElementAt(e)+t.equivalentExp_+t.moleExp_),i.equals(s)}_getUnitTables(){return s||(s=i(9376).UnitTables),s.getInstance()}}e.Unit=u},1214:(t,e,i)=>{"use strict";e.T=void 0;var s=function(t){if(t&&t.__esModule)return t;if(null===t||"object"!=typeof t&&"function"!=typeof t)return{default:t};var e=n();if(e&&e.has(t))return e.get(t);var i={},s=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var a=s?Object.getOwnPropertyDescriptor(t,r):null;a&&(a.get||a.set)?Object.defineProperty(i,r,a):i[r]=t[r]}return i.default=t,e&&e.set(t,i),i}(i(2291));function n(){if("function"!=typeof WeakMap)return null;var t=new WeakMap;return n=function(){return t},t}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var a=i(8878).Ucum,o=i(9944).Unit,l=i(9376).UnitTables,h=i(5298).PrefixTables;class u{constructor(){this.utabs_=l.getInstance(),this.pfxTabs_=h.getInstance(),this.openEmph_=a.openEmph_,this.closeEmph_=a.closeEmph_,this.bracesMsg_="",this.parensFlag_="parens_placeholder",this.pFlagLen_=this.parensFlag_.length,this.braceFlag_="braces_placeholder",this.bFlagLen_=this.braceFlag_.length,this.vcMsgStart_=null,this.vcMsgEnd_=null,this.retMsg_=[],this.parensUnits_=[],this.annotations_=[],this.suggestions=[]}useHTMLInMessages(t){void 0===t||t?(this.openEmph_=a.openEmphHTML_,this.closeEmph_=a.closeEmphHTML_):(this.openEmph_=a.openEmph_,this.closeEmph_=a.closeEmph_)}useBraceMsgForEachString(t){void 0===t||t?this.bracesMsg_=a.bracesMsg_:this.bracesMsg_=""}parseString(t,e,i){if(""===(t=t.trim())||null===t)throw Error("Please specify a unit expression to be validated.");"validate"===e?(this.vcMsgStart_=a.valMsgStart_,this.vcMsgEnd_=a.valMsgEnd_):(this.vcMsgStart_=a.cnvMsgStart_,this.vcMsgEnd_=a.cnvMsgEnd_),void 0===i||!1===i?this.suggestions_=null:this.suggestions_=[],this.retMsg_=[],this.parensUnits_=[],this.annotations_=[];let n=t,r=[];if(t=this._getAnnotations(t),this.retMsg_.length>0)r[0]=null,r[1]=null;else{this.retMsg_.length;let e=null;for(e in a.specUnits_)for(;-1!==t.indexOf(e);)t=t.replace(e,a.specUnits_[e]);if(t.indexOf(" ")>-1)throw Error("Blank spaces are not allowed in unit expressions.");let i=(r=this._parseTheString(t,n))[0];(s.isIntegerUnit(i)||"number"==typeof i)&&(i=new o({csCode_:n,ciCode_:n,magnitude_:i,name_:n}),r[0]=i)}return r[2]=this.retMsg_,this.suggestions_&&this.suggestions_.length>0&&(r[3]=this.suggestions_),r}_parseTheString(t,e){let i=null,n=this.retMsg_.length>0,r=this._processParens(t,e);n=r[2];let a=[];if(!n){t=r[0],e=r[1];let i=this._makeUnitsArray(t,e);if(!(n=i[2])){a=i[0],e=i[1];let t=a.length;for(let i=0;i<t;i++){let t=a[i].un;if(s.isIntegerUnit(t))a[i].un=Number(t);else if(t.indexOf(this.parensFlag_)>=0){let s=this._getParensUnit(t,e);n||(n=s[1]),n||(a[i].un=s[0])}else{let s=this._makeUnit(t,e);null===s[0]?n=!0:(a[i].un=s[0],e=s[1])}}}}return n||null!==a[0]&&" "!==a[0]&&void 0!==a[0].un&&null!==a[0].un||0!==this.retMsg_.length||(this.retMsg_.push(`Unit string (${e}) did not contain anything that could be used to create a unit, or else something that is not handled yet by this package.  Sorry`),n=!0),n||(i=this._performUnitArithmetic(a,e)),[i,e]}_getAnnotations(t){let e=t.indexOf("{");for(;e>=0;){let i=t.indexOf("}");if(i<0)this.retMsg_.push("Missing closing brace for annotation starting at "+this.openEmph_+t.substr(e)+this.closeEmph_),e=-1;else{let s=t.substring(e,i+1);if(u.VALID_ANNOTATION_REGEX.test(s)){let i=this.annotations_.length.toString();t=t.replace(s,this.braceFlag_+i+this.braceFlag_),this.annotations_.push(s),e=t.indexOf("{")}else this.retMsg_.push(u.INVALID_ANNOTATION_CHAR_MSG+this.openEmph_+s+this.closeEmph_),e=-1}}if(0==this.retMsg_.length){let e=t.indexOf("}");e>=0&&this.retMsg_.push("Missing opening brace for closing brace found at "+this.openEmph_+t.substring(0,e+1)+this.closeEmph_)}return t}_processParens(t,e){let i=[],s=0,n=!1,r=this.parensUnits_.length,a=0;for(;""!==t&&!n;){let o=0,l=0,h=t.indexOf("(");if(h<0){let e=t.indexOf(")");if(e>=0){let r=`Missing open parenthesis for close parenthesis at ${t.substring(0,e+a)}${this.openEmph_}${t.substr(e,1)}${this.closeEmph_}`;e<t.length-1&&(r+=`${t.substr(e+1)}`),this.retMsg_.push(r),i[s]=t,n=!0}else i[s]=t,t=""}else{o+=1;let u=t.length;h>0&&(i[s++]=t.substr(0,h));let c=0,d=h+1;for(;d<u&&o!=l;d++)"("===t[d]?o+=1:")"===t[d]&&(l+=1);if(o===l){c=d,i[s++]=this.parensFlag_+r.toString()+this.parensFlag_;let o=this._parseTheString(t.substring(h+1,c-1),e);null===o[0]?n=!0:"/"===t[h+1]?(this.retMsg_.push("Unary operator '/' is only allowed at the beginning of the main term, not inside a parenthesis."),n=!0):(e=o[1],this.parensUnits_[r++]=o[0],t=t.substr(c),a=c)}else i.push(e.substr(h)),this.retMsg_.push(`Missing close parenthesis for open parenthesis at ${e.substring(0,h+a)}${this.openEmph_}${e.substr(h,1)}${this.closeEmph_}${e.substr(h+1)}`),n=!0}}return n&&(this.parensUnits_=[]),[i.join(""),e,n]}_makeUnitsArray(t,e){let i=t.match(/([./]|[^./]+)/g),n=!1,r=[],o=/(^[0-9]+)(\[?[a-zA-Z\_0-9a-zA-Z\_]+\]?$)/;if("/"===i[0]?i.unshift("1"):"."===i[0]&&(this.retMsg_.push(`${e} is not a valid UCUM code. The multiplication operator at the beginning of the expression is not valid. A multiplication operator must appear only between two codes.`),n=!0),!n){if(!s.isNumericString(i[0])){let t=i[0].match(o);if(t&&3===t.length&&""!==t[1]&&""!==t[2]&&0!==t[2].indexOf(this.braceFlag_)){let s=t[2];if(!n&&-1!==t[2].indexOf(this.parensFlag_)){let i=this._getParensUnit(t[2],e);t[2]=i[0].csCode_,s=`(${t[2]})`,n=i[1]}n||(this.retMsg_.push(`${t[1]}${s} is not a valid UCUM code.  ${this.vcMsgStart_}${t[1]}.${s}${this.vcMsgEnd_}`),e=e.replace(`${t[1]}${s}`,`${t[1]}.${s}`),i[0]=t[2],i.unshift(t[1],"."))}}if(!n){let t=i.length;r=[{op:"",un:i[0]}];for(let l=1;l<t;l++){let h=i[l++];if(i[l]){if(-1!==a.validOps_.indexOf(i[l]))this.retMsg_.push(`${e} is not a valid UCUM code. A unit code is missing between${this.openEmph_}${h}${this.closeEmph_}and${this.openEmph_}${i[l]}${this.closeEmph_}in${this.openEmph_}${h}${i[l]}${this.closeEmph_}.`),l=t,n=!0;else if(s.isNumericString(i[l]))r.push({op:h,un:i[l]});else{let s=i[l].match(o);if(s&&3===s.length&&""!==s[1]&&""!==s[2]&&0!==s[2].indexOf(this.braceFlag_)){let i=s[0];if(n||-1===s[2].indexOf(this.parensFlag_)){let i="("+s[1]+"."+s[2]+")",a=this._processParens(i,e);a[2]?(l=t,n=!0):(this.retMsg_.push(`${s[0]} is not a valid UCUM code.  ${this.vcMsgStart_}${s[1]}.${s[2]}${this.vcMsgEnd_}`),e=e.replace(s[0],i),r.push({op:h,un:a[0]}))}else{let t=this._getParensUnit(s[2],e);if(s[2]=t[0].csCode_,i=`(${s[2]})`,!(n=t[1])){this.retMsg_.push(`${s[1]}${i} is not a valid UCUM code.  ${this.vcMsgStart_}${s[1]}.${i}${this.vcMsgEnd_}`);let t=`(${s[1]}.${i})`;e=e.replace(`${s[1]}${i}`,t);let a=this._processParens(t,e);(n=a[2])||r.push({op:h,un:a[0]})}}}else r.push({op:h,un:i[l]})}}else this.retMsg_.push(`${e} is not a valid UCUM code. It is terminated with the operator ${this.openEmph_}${h}${this.closeEmph_}.`),l=t,n=!0}}}return[r,e,n]}_getParensUnit(t,e){let i=!1,n=null,r=t.indexOf(this.parensFlag_),a=null;r>0&&(a=t.substr(0,r-1));let l=t.lastIndexOf(this.parensFlag_),h=null;l+this.pFlagLen_<t.length&&(h=t.substr(l+this.pFlagLen_));let u=t.substring(r+this.pFlagLen_,l);if(s.isNumericString(u))n=this.parensUnits_[Number(u)],t=s.isIntegerUnit(n)?n:n.csCode_;else throw Error(`Processing error - invalid parens number ${u} found in ${t}.`);if(a){if(s.isNumericString(a)){let e=n.getProperty("magnitude_");e*=Number(a),n.assignVals({magnitude_:e}),t=`${a}.${t}`,this.retMsg_.push(`${a}${t} is not a valid UCUM code.
`+this.vcMsgStart_+t+this.vcMsgEnd_)}else if(a.indexOf(this.braceFlag_)>=0){let i=this._getAnnoText(a,e);if(i[1]||i[2])throw Error(`Text found before the parentheses (${a}) included an annotation along with other text for parenthetical unit ${n.csCode_}`);t+=i[0],this.retMsg_.push(`The annotation ${i[0]} before the unit code is invalid.
`+this.vcMsgStart_+t+this.vcMsgEnd_)}else this.suggestions_?i="succeeded"!==this._getSuggestions(a):(this.retMsg_.push(`${a} preceding the unit code ${t} is invalid.  Unable to make a substitution.`),i=!0)}if(h){if(h.indexOf(this.braceFlag_)>=0){let i=this._getAnnoText(h,e);if(i[1]||i[2])throw Error(`Text found after the parentheses (${h}) included an annotation along with other text for parenthetical unit ${n.csCode_}`);t+=i[0]}else if(s.isNumericString(h)){n=null;let e=`An exponent (${h}) following a parenthesis is invalid as of revision 1.9 of the UCUM Specification.`;t.match(/\d$/)||(t+=h,e+="\n  "+this.vcMsgStart_+t+this.vcMsgEnd_),this.retMsg_.push(e),i=!0}else this.suggestions_?i="succeeded"!==this._getSuggestions(a):(this.retMsg_.push(`Text ${h} following the unit code ${t} is invalid.  Unable to make a substitution.`),i=!0)}return i||(n?s.isIntegerUnit(n)?n=new o({csCode_:n,magnitude_:n,name_:n}):n.csCode_=t:n=new o({csCode_:t,magnitude_:1,name_:t})),[n,i]}_getAnnoText(t,e){let i=t.indexOf(this.braceFlag_),n=i>0?t.substring(0,i):null;0!==i&&(t=t.substr(i));let r=t.indexOf(this.braceFlag_,1),a=r+this.bFlagLen_<t.length?t.substr(r+this.bFlagLen_):null,o=t.substring(this.bFlagLen_,r),l=Number(o);if(!s.isNumericString(o)||l>=this.annotations_.length)throw Error(`Processing Error - invalid annotation index ${o} found in ${t} that was created from ${e}`);return[t=this.annotations_[l],n,a]}_getSuggestions(t){let e=s.getSynonyms(t);if("succeeded"===e.status){let i={};i.msg=`${t} is not a valid UCUM code.  We found possible units that might be what was meant:`,i.invalidUnit=t;let s=e.units.length;i.units=[];for(let t=0;t<s;t++){let s=e.units[t],n=[s.code,s.name,s.guidance];i.units.push(n)}this.suggestions_.push(i)}else this.retMsg_.push(`${t} is not a valid UCUM code.  No alternatives were found.`);return e.status}_makeUnit(t,e){let i=this.utabs_.getUnitByCode(t);if(i)i=i.clone();else if(t.indexOf(this.braceFlag_)>=0){let s=this._getUnitWithAnnotation(t,e);(i=s[0])&&(e=s[1])}else{if(t.indexOf("^")>-1){let e=t.replace("^","*");(i=this.utabs_.getUnitByCode(e))&&((i=i.clone()).csCode_=i.csCode_.replace("*","^"),i.ciCode_=i.ciCode_.replace("*","^"))}if(!i){let s="["+t+"]";(i=this.utabs_.getUnitByCode(s))&&(i=i.clone(),e=e.replace(t,s),this.retMsg_.push(`${t} is not a valid unit expression, but ${s} is.
`+this.vcMsgStart_+`${s} (${i.name_})${this.vcMsgEnd_}`))}if(!i){let s=this.utabs_.getUnitByName(t);if(s&&s.length>0){i=s[0].clone();let n="The UCUM code for "+t+" is "+i.csCode_+".\n"+this.vcMsgStart_+i.csCode_+this.vcMsgEnd_,r=!1;for(let t=0;t<this.retMsg_.length&&!r;t++)r=this.retMsg_[t]===n;r||this.retMsg_.push(n);let a=RegExp("(^|[./({])("+t+")($|[./)}])"),o=e.match(a);e=e.replace(a,o[1]+i.csCode_+o[3]),t=i.csCode_}}if(!i){let e=null;for(e in a.specUnits_)-1!==t.indexOf(a.specUnits_[e])&&(t=t.replace(a.specUnits_[e],e));(i=this.utabs_.getUnitByCode(t))&&(i=i.clone())}if(!i){let e=t,n=null,r=null,a=null,l=null,h=null,u=null,c=this._isCodeWithExponent(t),d=!1;if(c&&(t=c[0],r=c[1],n=(d=s.isIntegerUnit(t))?new o({csCode_:t,ciCode_:t,magnitude_:Number(t),name_:t}):this.utabs_.getUnitByCode(t)),r&&isNaN(r))i=null,this.retMsg_.push(`${e} is not a valid UCUM code.`);else{if(!n&&(a=t.charAt(0),l=this.pfxTabs_.getPrefixByCode(a))){h=l.getValue(),u=l.getExp();let e=a.length;t=t.substr(e),(n=this.utabs_.getUnitByCode(t))||"d"!=a||"a"!=t.substr(0,1)||(a="da",h=(l=this.pfxTabs_.getPrefixByCode(a)).getValue(),t=t.substr(1),n=this.utabs_.getUnitByCode(t)),n&&"LOINC"==n.source_&&(n=null)}if(n){(i=n.clone()).resetFieldsForDerivedUnit();let t=i.getProperty("dim_"),e=i.getProperty("magnitude_"),s=i.getProperty("name_"),o=i.getProperty("ciCode_"),c=i.getProperty("printSymbol_");if(r){let s=r=parseInt(r);t&&(t=t.mul(r)),i.equivalentExp_*=r,i.moleExp_*=r,e=Math.pow(e,r),i.assignVals({magnitude_:e}),l&&u&&(s*=l.getExp(),h=Math.pow(10,s))}l&&(i.cnv_?i.assignVals({cnvPfx_:h}):(e*=h,i.assignVals({magnitude_:e})));let _=i.csCode_;if(l&&(s=l.getName()+s,_=a+_,o=l.getCiCode()+o,c=l.getPrintSymbol()+c,i.assignVals({name_:s,csCode_:_,ciCode_:o,printSymbol_:c})),r){let t=r.toString(),e=d&&r>0?"+":"";i.assignVals({name_:s+"<sup>"+t+"</sup>",csCode_:_+e+t,ciCode_:o+e+t,printSymbol_:c+"<sup>"+t+"</sup>"})}}else i=null,this.suggestions_?this._getSuggestions(e):this.retMsg_.push(`${e} is not a valid UCUM code.`)}}}return[i,e]}_getUnitWithAnnotation(t,e){let i=null,n=this._getAnnoText(t,e),r=n[0],a=n[1],l=n[2];this.bracesMsg_&&-1===this.retMsg_.indexOf(this.bracesMsg_)&&this.retMsg_.push(this.bracesMsg_);let h=this.retMsg_.length;if(a||l){if(a&&!l){if(s.isIntegerUnit(a))i=new o({csCode_:a+r,ciCode_:a+r.toUpperCase(),magnitude_:Number(a),name_:a+r});else{let t=this._makeUnit(a,e);t[0]?(i=t[0],i.csCode_+=r,e=t[1]):this.retMsg_.push(`Unable to find a unit for ${a} that precedes the annotation ${r}.`)}}else if(!a&&l){if(s.isIntegerUnit(l))i=l+r,this.retMsg_.push(`The annotation ${r} before the ``${l} is invalid.\n`+this.vcMsgStart_+i+this.vcMsgEnd_);else{let t=this._makeUnit(l,e);t[0]?(i=t[0],i.csCode_+=r,e=i.csCode_,this.retMsg_.push(`The annotation ${r} before the unit code is invalid.
`+this.vcMsgStart_+i.csCode_+this.vcMsgEnd_)):this.retMsg_.push(`Unable to find a unit for ${a} that follows the annotation ${r}.`)}}else this.retMsg_.push(`Unable to find a unit for ${a}${r}${l}.
We are not sure how to interpret text both before and after the annotation.  Sorry`)}else{let s="["+r.substring(1,r.length-1)+"]",n=this._makeUnit(s,e);n[0]?(i=t,this.retMsg_.push(`${r} is a valid unit expression, but did you mean ${s} (${n[0].name_})?`)):this.retMsg_.length>h&&this.retMsg_.pop(),i=new o({csCode_:r,ciCode_:r,magnitude_:1,name_:r})}return[i,e]}_performUnitArithmetic(t,e){let i=t[0].un;s.isIntegerUnit(i)&&(i=new o({csCode_:i,ciCode_:i,magnitude_:Number(i),name_:i}));let n=t.length,r=!1;for(let a=1;a<n&&!r;a++){let n=t[a].un;if(s.isIntegerUnit(n)&&(n=new o({csCode_:n,ciCode_:n,magnitude_:Number(n),name_:n})),null!==n&&("number"==typeof n||n.getProperty))try{let e=t[a].op;i="/"===e?i.divide(n):i.multiplyThese(n)}catch(t){this.retMsg_.unshift(t.message),r=!0,i=null}else{let t=`Unit string (${e}) contains unrecognized element`;n&&(t+=` (${this.openEmph_}${n.toString()}${this.closeEmph_})`),t+="; could not parse full string.  Sorry",this.retMsg_.push(t),r=!0}}return i}_isCodeWithExponent(t){let e=[],i=t.match(/(^[^\-\+]+?)([\-\+\d]+)$/);return i&&i[2]&&""!==i[2]?(e.push(i[1]),e.push(i[2])):e=null,e}}e.T=u,r(u,"INVALID_ANNOTATION_CHAR_MSG","An invalid character was found in the annotation "),r(u,"VALID_ANNOTATION_REGEX",/^\{[!-z|~]*\}$/),u.getInstance=function(){return new u}},9376:(t,e,i)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.UnitTables=void 0;var s=i(8878).Ucum;class n{constructor(){this.unitNames_={},this.unitCodes_={},this.codeOrder_=[],this.unitStrings_={},this.unitDimensions_={},this.unitSynonyms_={},this.massDimIndex_=0,this.dimVecIndexToBaseUnit_={}}unitsCount(){return Object.keys(this.unitCodes_).length}addUnit(t){t.name_&&this.addUnitName(t),this.addUnitCode(t),this.addUnitString(t);try{t.dim_.getProperty("dimVec_")&&this.addUnitDimension(t)}catch(t){}if(t.isBase_){let e;let i=t.dim_.dimVec_;for(let t=0,s=i.length;void 0==e&&t<s;++t)0!=i[t]&&(e=t);this.dimVecIndexToBaseUnit_[e]=t.csCode_}}addUnitName(t){let e=t.name_;if(e)this.unitNames_[e]?this.unitNames_[e].push(t):this.unitNames_[e]=[t];else throw Error(`UnitTables.addUnitName called for a unit with no name.  Unit code = ${t.csCode_}.`)}addUnitCode(t){let e=t.csCode_;if(e){if(this.unitCodes_[e])throw Error(`UnitTables.addUnitCode called, already contains entry for unit with code = ${e}`);if(this.unitCodes_[e]=t,this.codeOrder_.push(e),"g"==e){let e=t.dim_.dimVec_,i=0;for(;i<e.length&&e[i]<1;i++);this.massDimIndex_=i}}else throw Error("UnitTables.addUnitCode called for unit that has no code.")}addUnitString(t){let e=null;if(e=!0==s.caseSensitive_?t.csUnitString_:t.ciUnitString_){let i={mag:t.baseFactorStr_,unit:t};this.unitStrings_[e]?this.unitStrings_[e].push(i):this.unitStrings_[e]=[i]}}addUnitDimension(t){let e=t.dim_.getProperty("dimVec_");if(e)this.unitDimensions_[e]?this.unitDimensions_[e].push(t):this.unitDimensions_[e]=[t];else throw Error(`UnitTables.addUnitDimension called for a unit with no dimension.  Unit code = ${t.csCode_}.`)}buildUnitSynonyms(){for(let t in this.unitCodes_){let e=this.unitCodes_[t],i=e.synonyms_;if(i){let e=i.split(";");if(""!==e[0]){let i=e.length;for(let s=0;s<i;s++){let i=e[s].trim();this.addSynonymCodes(t,i)}}}this.addSynonymCodes(t,e.name_)}}addSynonymCodes(t,e){let i=e.split(" "),s=i.length;for(let e=0;e<s;e++){let s=i[e];this.unitSynonyms_[s]?-1===this.unitSynonyms_[s].indexOf(t)&&this.unitSynonyms_[s].push(t):this.unitSynonyms_[s]=[t]}}getUnitByCode(t){let e=null;return t&&(e=this.unitCodes_[t]),e}getUnitByName(t){if(null==t)throw Error("Unable to find unit by name because no name was provided.");let e=t.indexOf(s.codeSep_),i=null;e>=1&&(i=t.substr(e+s.codeSep_.length),t=t.substr(0,e));let n=this.unitNames_[t];if(n){let t=n.length;if(i&&t>1){let e=0;for(;n[e].csCode_!==i&&e<t;e++);n=e<t?[n[e]]:null}}return n}getUnitByString(t){let e=null;return t&&void 0===(e=this.unitStrings_[t])&&(e=null),e}getUnitsByDimension(t){let e=null;if(null==t)throw Error("Unable to find unit by because no dimension vector was provided.");return null==(e=this.unitDimensions_[t])&&console.log(`Unable to find unit with dimension = ${t}`),e}getUnitBySynonym(t){let e={},i=[];try{if(null==t)throw e.status="error",Error("Unable to find unit by synonym because no synonym was provided.");0===Object.keys(this.unitSynonyms_).length&&this.buildUnitSynonyms();let s=[];if(s=this.unitSynonyms_[t]){e.status="succeeded";let t=s.length;for(let e=0;e<t;e++)i.push(this.unitCodes_[s[e]]);e.units=i}0===i.length&&(e.status="failed",e.msg=`Unable to find any units with synonym = ${t}`)}catch(t){e.msg=t.message}return e}getAllUnitNames(){return Object.keys(this.unitNames_)}getUnitNamesList(){let t=[],e=Object.keys(this.unitCodes_);e.sort(this.compareCodes);let i=e.length;for(let n=0;n<i;n++)t[n]=e[n]+s.codeSep_+this.unitCodes_[e[n]].name_;return t}getMassDimensionIndex(){return this.massDimIndex_}compareCodes(t,e){return t=(t=t.replace(/[\[\]]/g,"")).toLowerCase(),e=(e=e.replace(/[\[\]]/g,"")).toLowerCase(),t<e?-1:1}getAllUnitCodes(){return Object.keys(this.unitCodes_)}allUnitsByDef(){let t=[],e=this.codeOrder_.length;for(let i=0;i<e;i++)t.push(this.getUnitByCode(this.codeOrder_[i]));return t}allUnitsByName(t,e){null==e&&(e="|");let i="",s=this.getAllUnitNames(),n=s.length,r=t.length;for(let a=0;a<n;a++){let n=this.getUnitByName(s[a]);for(let s=0;s<n.length;s++){let a=n[s];for(let s=0;s<r;s++)if(s>0&&(i+=e),"dim_"===t[s])null!==a.dim_&&void 0!==a.dim_&&a.dim_.dimVec_ instanceof Array?i+="["+a.dim_.dimVec_.join(",")+"]":i+="";else{let e=a[t[s]];"string"==typeof e?i+=e.replace(/[\n\r]/g," "):i+=e}i+="\r\n"}}return i}printUnits(t,e){void 0===t&&(t=!1),void 0===e&&(e="|");let i="",s=this.codeOrder_.length,n="csCode"+e;t&&(n+="ciCode"+e),n+="name"+e,t&&(n+="isBase"+e),n+="magnitude"+e+"dimension"+e+"from unit(s)"+e+"value"+e+"function"+e,t&&(n+="property"+e+"printSymbol"+e+"synonyms"+e+"source"+e+"class"+e+"isMetric"+e+"variable"+e+"isSpecial"+e+"isAbitrary"+e),n+="comment",i=n+"\n";for(let r=0;r<s;r++){let s=this.getUnitByCode(this.codeOrder_[r]);n=this.codeOrder_[r]+e,t&&(n+=s.getProperty("ciCode_")+e),n+=s.getProperty("name_")+e,t&&(s.getProperty("isBase_")?n+="true"+e:n+="false"+e),n+=s.getProperty("magnitude_")+e;let a=s.getProperty("dim_");a?n+=a.dimVec_+e:n+="null"+e,s.csUnitString_?n+=s.csUnitString_+e+s.baseFactor_+e:n+="null"+e+"null"+e,s.cnv_?n+=s.cnv_+e:n+="null"+e,t&&(n+=s.getProperty("property_")+e+s.getProperty("printSymbol_")+e+s.getProperty("synonyms_")+e+s.getProperty("source_")+e+s.getProperty("class_")+e+s.getProperty("isMetric_")+e+s.getProperty("variable_")+e+s.getProperty("isSpecial_")+e+s.getProperty("isArbitrary_")+e),s.defError_&&(n+="problem parsing this one, deferred to later."),i+=n+"\n"}return i}}var r=new n;e.UnitTables={getInstance:function(){return r}}},3688:t=>{"use strict";t.exports=Number.isFinite||function(t){return!("number"!=typeof t||t!=t||t===1/0||t===-1/0)}},6641:(t,e,i)=>{var s=i(3688);t.exports=Number.isInteger||function(t){return"number"==typeof t&&s(t)&&Math.floor(t)===t}}}]);