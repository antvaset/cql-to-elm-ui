(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{3369:(e,t,n)=>{Promise.resolve().then(n.bind(n,6940))},7247:(e,t,n)=>{"use strict";n.d(t,{M:()=>i});var o=n(7437),r=n(3997),s=n(7924);function i(e){let{gridArea:t,value:n,onChange:i,editable:d,extensions:a}=e;return(0,o.jsx)(r.ZP,{style:{gridArea:t,minWidth:0,minHeight:0,background:"white",border:"1px solid #777",borderRadius:2.5},height:"100%",width:"100%",editable:d,theme:s.tk.theme({".cm-content":{padding:"8px 0"},".cm-line":{padding:"0 10px"}}),basicSetup:{foldGutter:!1,highlightActiveLine:!1,lineNumbers:!1,searchKeymap:!1},value:n,extensions:[s.tk.lineWrapping,...a],onChange:i})}},6940:(e,t,n)=>{"use strict";n.a(e,async(e,o)=>{try{n.d(t,{CqlCompilerPlayground:()=>y});var r=n(7437),s=n(2265),i=n(7529),d=n(704),a=n(7071),l=n(1439),u=n(7247),c=e([a]);a=(c.then?(await c)():c)[0];let g={cql:"library Test version '0.1.0'\n\nusing FHIR version '4.0.1'\n\ninclude FHIRHelpers version '4.0.1'\n\nvalueset \"Encounter Inpatient\": 'http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307'\n\nparameter \"Measurement Period\" Interval<DateTime>\n\ncontext Patient\n\ndefine \"Inpatient Encounter\":\n  [Encounter: \"Encounter Inpatient\"] EncounterInpatient\n    where EncounterInpatient.status = 'finished'\n      and EncounterInpatient.period ends during day of \"Measurement Period\"\n",useWasm:!1,enableAnnotations:!1,enableLocators:!1,outputContentType:"json",baseUrl:"https://raw.githubusercontent.com/cqframework/cqf-exercises/refs/heads/master/input/cql/"};function y(){let[e,t]=(0,s.useState)({...g,isBusy:!0,output:{type:"log",log:"Getting ready..."},useWorker:!0}),o=(0,s.useRef)(null),c=(0,s.useRef)(null),y=(0,s.useRef)(0);return(0,s.useEffect)(()=>{(async()=>{t(e=>({...e,isBusy:!0}));let r=++y.current;if(e.useWorker){let o=(()=>{if(c.current)return c.current;let e=(async()=>{let e=new Worker(n.tu(new URL(n.p+n.u(156),n.b)));return await new Promise(t=>{e.onmessage=e=>{"ready"===e.data.type&&t()}}),e.onmessage=e=>{let{type:n,data:o}=e.data;"output"===n&&o.runId===y.current&&t(e=>({...e,isBusy:"log"===o.output.type,output:o.output}))},e})();return c.current=e,e})();(await o).postMessage({type:"compileCql",data:{args:{cql:e.cql,useWasm:e.useWasm,enableAnnotations:e.enableAnnotations,enableLocators:e.enableLocators,outputContentType:e.outputContentType,baseUrl:e.baseUrl},runId:r}})}else{let{compileCql:n}=(()=>{if(o.current)return o.current;let e=(0,a.P)();return o.current=e,e})();n({cql:e.cql,useWasm:e.useWasm,enableAnnotations:e.enableAnnotations,enableLocators:e.enableLocators,outputContentType:e.outputContentType,baseUrl:e.baseUrl},e=>{r===y.current&&t(t=>({...t,isBusy:"log"===e.type,output:e}))})}})()},[e.cql,e.useWasm,e.enableAnnotations,e.enableLocators,e.outputContentType,e.baseUrl,e.useWorker]),(0,r.jsxs)("div",{style:{position:"absolute",inset:0,padding:20,display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr",gridTemplateAreas:'"header" "body"',gap:10,minHeight:0},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:20},children:[(0,r.jsx)("h1",{style:{gridArea:"header",margin:0,fontSize:24,flex:"1 0 auto"},children:"CQL Compiler in Kotlin/JS â€” Demo"}),(0,r.jsx)("a",{style:{flex:"0 0 auto"},href:"https://github.com/cqframework/clinical_quality_language/tree/feature-kotlin/Src/js/cql-to-elm-ui",children:"View source"})]}),(0,r.jsxs)("div",{style:{gridArea:"body",display:"grid",gridTemplateColumns:"1fr 1fr",gridTemplateRows:"auto 1fr",gridTemplateAreas:'"body-config body-config" "body-left-editor body-right-editor"',gap:"15px 20px",minHeight:0},children:[(0,r.jsxs)("div",{style:{gridArea:"body-config",display:"grid",gridTemplateColumns:"1fr 1fr 1fr 1fr",gap:20,alignItems:"center"},children:[(0,r.jsxs)("label",{style:{display:"block",gridColumn:"1 / span 2"},children:[(0,r.jsx)("div",{style:{fontWeight:700,margin:"0 0 5px 0"},children:"Library base URL"}),(0,r.jsx)("input",{placeholder:"E.g. https://raw.githubusercontent.com/cqframework/cqf-exercises/refs/heads/master/input/cql/",value:e.baseUrl,onChange:async e=>{let n=e.target.value;t(e=>({...e,baseUrl:n}))},style:{width:"100%",padding:"8px 10px"}})]}),(0,r.jsxs)("div",{style:{gridColumn:"3 / span 2",display:"grid",gap:8},children:[(0,r.jsx)("div",{children:(0,r.jsxs)("div",{style:{display:"flex",gap:5},children:[(0,r.jsx)("div",{style:{fontWeight:700},children:"Compiler options:"}),(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e.enableAnnotations,onChange:e=>{let n=e.target.checked;t(e=>({...e,enableAnnotations:n}))}}),"Enable annotations"]}),(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e.enableLocators,onChange:e=>{let n=e.target.checked;t(e=>({...e,enableLocators:n}))}}),"Enable locators"]})]})}),(0,r.jsxs)("div",{style:{display:"grid",gap:5},children:[(0,r.jsxs)("div",{style:{display:"flex",gap:5,margin:"0 0 2px 0"},children:[(0,r.jsx)("div",{style:{fontWeight:700},children:"Output content type:"}),["json","xml"].map(n=>(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"radio",checked:e.outputContentType===n,onChange:()=>{t(e=>({...e,outputContentType:n}))}}),n.toUpperCase()]},n))]}),(0,r.jsxs)("div",{style:{display:"flex",gap:10},children:[(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e.useWorker,onChange:e=>{let n=e.target.checked;t(e=>({...e,useWorker:n}))}}),"Use worker"]}),(0,r.jsxs)("label",{style:{display:"block"},children:[(0,r.jsx)("input",{type:"checkbox",checked:e.useWasm,onChange:e=>{let n=e.target.checked;t(e=>({...e,useWasm:n}))}}),"Use WASM"]})]})]})]})]}),(0,r.jsxs)("div",{style:{gridArea:"body-left-editor",display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr",gridTemplateAreas:'"body-left-editor-label" "body-left-editor-textarea"'},children:[(0,r.jsx)("div",{style:{gridArea:"body-left-editor-label"},children:(0,r.jsx)("div",{style:{fontWeight:700,margin:"0 0 5px 0"},children:"Library CQL"})}),(0,r.jsx)(u.M,{gridArea:"body-left-editor-textarea",value:e.cql,onChange:e=>{t(t=>({...t,cql:e}))},editable:!0,extensions:[l.v]})]}),(0,r.jsxs)("div",{style:{gridArea:"body-right-editor",display:"grid",gridTemplateColumns:"1fr",gridTemplateRows:"auto 1fr",gridTemplateAreas:'"body-right-editor-label" "body-right-editor-textarea"',minHeight:0},children:[(0,r.jsx)("div",{style:{gridArea:"body-right-editor-label"},children:(0,r.jsx)("div",{style:{fontWeight:700,margin:"0 0 5px 0",background:e.isBusy?"url(https://upload.wikimedia.org/wikipedia/en/6/6f/Windows_hourglass_cursor.png) right center/auto no-repeat":"none"},children:"Library ELM"})}),(0,r.jsx)(u.M,{gridArea:"body-right-editor-textarea",value:(()=>{if("log"===e.output.type)return e.output.log;if("json"===e.output.contentType)try{return JSON.stringify(JSON.parse(e.output.elm),null,2)}catch(e){console.error(e)}return e.output.elm})(),onChange:()=>{},editable:!1,extensions:"log"===e.output.type?[]:"json"===e.output.contentType?[(0,i.AV)()]:[(0,d.Ls)()]})]})]})]})}o()}catch(e){o(e)}})},1439:(e,t,n)=>{"use strict";n.d(t,{v:()=>s});var o=n(4241),r=n(2463);let s=o.il.define((0,r.Q)({start:[{regex:/\/\/.*/,token:"comment"},{regex:/\/\*/,token:"comment",next:"comment"},{regex:/"(?:[^\\]|\\.)*?(?:"|$)/,token:"def"},{regex:/'(?:[^\\]|\\.)*?(?:'|$)/,token:"string"},{regex:/'(?:[^\\]|\\.)*?(?:'|$)/,token:"string-2"},{regex:/[\{\[\(]/,indent:!0},{regex:/[\}\]\)]/,dedentIfLineStart:!0},{regex:/\b(context +)(Patient|Population)\b/,token:["keyword",null]},{regex:/\b(predecessor +of|successor +of|singleton +from)\b/,token:"keyword"},{regex:/\b(year|month|day|hour|minute|second|millisecond|timezone|date|time) +from\b/,token:"keyword"},{regex:/\b(years|months|days|hours|minutes|seconds|milliseconds) +between\b/,token:"keyword"},{regex:/\b(width +of|such that)\b/,token:"keyword"},{regex:/\b(Coalesce|is +null|is +not +null)\b/,token:"keyword"},{regex:/\b(difference)( +in +)(years|months|days|hours|minutes|seconds|milliseconds)( +between)\b/,token:["keyword","keyword","keyword","keyword"]},{regex:/\b(start|end)( +of)\b/,token:["keyword","keyword"]},{regex:/\b(properly +)(contains|includes|during|included +in)\b/,token:["keyword","keyword"]},{regex:/\b(contains|includes|during|included +in)\b/,token:["keyword","keyword"]},{regex:/\b(properly +)(between)\b/,token:["keyword","keyword"]},{regex:/\b(same +)(year|month|day|hour|minute|second|millisecond)( +)(or +before|or +after|as)\b/,token:["keyword","keyword",null,"keyword"]},{regex:/\b(same +)(or +before|or +after|as)\b/,token:["keyword","keyword"]},{regex:/\b(properly +)(within +)(\d+)(\s+)(year|month|day|hour|minute|second|millisecond)( +of)\b/,token:["keyword","keyword","number",null,"keyword","keyword"]},{regex:/\b(properly +)(within +)(\d+)(\s+)(years|months|days|hours|minutes|seconds|milliseconds)( +of)\b/,token:["keyword","keyword","number",null,"keyword","keyword"]},{regex:/\b(within +)(\d+)(\s+)(years|months|days|hours|minutes|seconds|milliseconds)( +of)\b/,token:["keyword","number",null,"keyword","keyword"]},{regex:/\b(year|month|day|hour|minute|second|millisecond)( +or +)(less|more)( +)(before|after)\b/,token:["keyword","keyword","keyword",null,"keyword"]},{regex:/\b(years|months|days|hours|minutes|seconds|milliseconds)( +or +)(less|more)( +)(before|after)\b/,token:["keyword","keyword","keyword","keyword","keyword"]},{regex:/\b(year|month|day|hour|minute|second|millisecond)( +)(before|after)\b/,token:["keyword",null,"keyword"]},{regex:/\b(years|months|days|hours|minutes|seconds|milliseconds)( +)(before|after)\b/,token:["keyword",null,"keyword"]},{regex:/\b(CalculateAge)(In)(Years|Months|Days|Hours|Minutes|Seconds)(At)\b/,token:["keyword","keyword","keyword","keyword"]},{regex:/\b(CalculateAge)(In)(Years|Months|Days|Hours|Minutes|Seconds)\b/,token:["keyword","keyword","keyword"]},{regex:/\b(Age)(In)(Years|Months|Days|Hours|Minutes|Seconds)(At)\b/,token:["keyword","keyword","keyword","keyword"]},{regex:/\b(Age)(In)(Years|Months|Days|Hours|Minutes|Seconds)\b/,token:["keyword","keyword","keyword"]},{regex:/\b(sort +)(ascending|descending)( +by)(.*)(ascending|descending)\b/,token:["keyword","keyword","keyword",null,"keyword"]},{regex:/\b(sort +)(asc|desc)( +by)(.*)(asc|desc)\b/,token:["keyword","keyword","keyword",null,"keyword"]},{regex:/\b(sort +)(by)(.*)(ascending|descending)\b/,token:["keyword","keyword",null,"keyword"]},{regex:/\b(sort +)(by)(.*)(asc|desc)\b/,token:["keyword","keyword",null,"keyword"]},{regex:/\b(by)(.*)(ascending|descending)\b/,token:["keyword",null,"keyword"]},{regex:/\b(by)(.*)(asc|desc)\b/,token:["keyword",null,"keyword"]},{regex:/\B\@\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\.\d{3}\b/,token:"tag"},{regex:/\B\@\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}\b/,token:"tag"},{regex:/\B\@\d{4}-\d{2}-\d{2}T\d{2}:\d{2}\b/,token:"tag"},{regex:/\B\@\d{4}-\d{2}-\d{2}T\d{2}\b/,token:"tag"},{regex:/\B\@\d{4}-\d{2}-\d{2}\b/,token:"tag"},{regex:/\B\@\d{4}-\d{2}\b/,token:"tag"},{regex:/\B\@\d{4}\b/,token:"tag"},{regex:/\B\@T\d{2}:\d{2}:\d{2}\b/,token:"tag"},{regex:/\B\@T\d{2}:\d{2}:\d{2}\b/,token:"tag"},{regex:/\B\@T\d{2}:\d{2}\b/,token:"tag"},{regex:/\B\@T\d{2}\b/,token:"tag"},{sol:!0,regex:/(after|all|and|as|asc|ascending|before|between|by|called|case|cast|codesystem|codesystems|collapse|contains|convert|day|days|default|define|desc|descending|difference|display|distinct|div|duration|during|else|end|ends|except|exists|flatten|from|function|hour|hours|if|implies|in|include|includes|intersect|is|let|library|maximum|meets|millisecond|milliseconds|minimum|minute|minutes|mod|month|months|not|occurs|of|or|overlaps|parameter|predecessor|private|public|return|same|singleton|second|seconds|start|starts|successor|then|to|union|using|valueset|version|week|weeks|where|when|with|within|without|xor|year|years)\b/,token:"keyword"},{regex:/(\w\W|\W)(after|all|and|as|asc|ascending|before|between|by|called|case|cast|codesystem|codesystems|collapse|contains|convert|day|days|default|define|desc|descending|difference|display|distinct|div|duration|during|else|end|ends|except|exists|flatten|from|function|hour|hours|if|implies|in|include|includes|intersect|is|let|library|maximum|meets|millisecond|milliseconds|minimum|minute|minutes|mod|month|months|not|occurs|of|or|overlaps|parameter|predecessor|private|public|return|same|singleton|second|seconds|start|starts|successor|then|to|union|using|valueset|version|week|weeks|where|when|with|within|without|xor|year|years)\b/,token:[null,"keyword"]},{sol:!0,regex:/(Any|Boolean|Code|Concept|DateTime|Decimal|Integer|Interval|List|Quantity|String|Time|Tuple|AllTrue|AnyTrue|Avg|Count|Max|Min|Median|Mode|PopulationStdDev|PopulationVariance|StdDev|Sum|Variance|First|IndexOf|Last|Length|Now|TimeOfDay|Today|Combine|Length|Lower|PositionOf|Split|Substring|Upper|Abs|Ceiling|Floor|Log|Ln|Round|Truncate|ToBoolean|ToConcept|ToDateTime|ToDecimal|ToInteger|ToQuantity|ToString|ToTime)\b/,token:"builtin"},{regex:/(\w\W|\W)(Any|Boolean|Code|Concept|DateTime|Decimal|Integer|Interval|List|Quantity|String|Time|Tuple|AllTrue|AnyTrue|Avg|Count|Max|Min|Median|Mode|PopulationStdDev|PopulationVariance|StdDev|Sum|Variance|First|IndexOf|Last|Length|Now|TimeOfDay|Today|Combine|Length|Lower|PositionOf|Split|Substring|Upper|Abs|Ceiling|Floor|Log|Ln|Round|Truncate|ToBoolean|ToConcept|ToDateTime|ToDecimal|ToInteger|ToQuantity|ToString|ToTime)\b/,token:[null,"builtin"]},{sol:!0,regex:/(true|false|null)\b/,token:"atom"},{regex:/\d/i,token:"number"},{regex:/(\w\W|\W)(true|false|null)\b/,token:[null,"atom"]}],comment:[{regex:/.*?\*\//,token:"comment",next:"start"},{regex:/.*/,token:"comment"}],meta:{dontIndentStates:["comment"],lineComment:"//"}}))}},e=>{var t=t=>e(e.s=t);e.O(0,[663,401,103,226,71,130,215,744],()=>t(3369)),_N_E=e.O()}]);